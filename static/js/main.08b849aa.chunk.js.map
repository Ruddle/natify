{"version":3,"sources":["frag/Compute.js","webpack:///./src/frag/Compute.js?4145","logo.svg","frag/utils.js","frag/Interp.js","frag/Curve.js","frag/Grid.js","frag/InSound.js","frag/RSlider.js","frag/Editor.js","App.js","reportWebVitals.js","index.js"],"names":["inst","wrap","Worker","module","exports","f","this","flatstep","a","b","x","Math","max","min","clamp","smoothstep","t","mix","m","useAnimationFrame","callback","requestRef","React","useRef","previousTimeRef","animate","time","undefined","current","deltaTime","requestAnimationFrame","useEffect","cancelAnimationFrame","Interp","arr","i","length","i2","round","phase","k","floor","getWrap","getTangent","p","t2","t3","cloneDeep","require","Curve","name","value","onChange","stateTemp","canvasRef","useState","toDisplay","setToDisplay","canvas","get","mode","s","nearest","linear","cubic","ctx","getContext","clearRect","fillStyle","fillRect","beginPath","moveTo","lineTo","strokeStyle","stroke","lineWidth","fill","drawing","setDrawing","window","addEventListener","console","log","style","display","flexDirection","textAlign","color","fontSize","fontWeight","justifyContent","border","cursor","onClick","width","height","borderRadius","overflow","onMouseMove","e","rect","target","getBoundingClientRect","clientX","left","y","clientY","top","onMouseDown","ref","Grid","map","row","rowIndex","col","colIndex","backgroundColor","newVal","getMedia","navigator","mediaDevices","getUserMedia","audio","stream","error","AudioBufferVisu","audioBuffer","s2y","h","w","d","getChannelData","fix","str","padEnd","whiteSpace","duration","numberOfChannels","sampleRate","InSound","file","setFile","convertBlobToAudioBuffer","chunks","mediaRecorder","started","recorderState","setRecorderState","setAudioBuffer","startRecord","useCallback","MediaRecorder","start","ondataavailable","data","push","stopRecord","stop","myBlob","audioContext","AudioContext","fileReader","FileReader","onloadend","myArrayBuffer","result","decodeAudioData","readAsArrayBuffer","padding","flex","marginLeft","marginBottom","for","borderLeft","files","type","id","multiple","polarToCartesian","centerX","centerY","radius","angle","cos","sin","describeArc","startAngle","endAngle","end","largeArcFlag","PI","join","WIDTH","SvgComponent","state","useMemo","a2","arcpaths","cx","cy","viewBox","boxSizing","x1","x2","y1","y2","offset","stopColor","r","strokeWidth","index","strokeLinecap","format","step","RSlider","maxTurn","unit","mousemove","event","rectSize","center","relativeX","relativeY","angleBetweenTwoVectors","atan2","isNaN","newValue","clicked","setClicked","hover","setHover","removeEventListener","userSelect","position","boxShadow","transition","onMouseEnter","onMouseLeave","transform","qs","_","worker","MyWorker","tuto1","tuto2","tuto3","tuto4","tuto5","tuto6","tuto7","drawBuffer","buffers","dstate","bufferIndex","buffer","resetTransform","translate","scale","trans","Array","isArray","constructor","Float32Array","minY","reduce","prev","curr","maxY","split","vToH","v","iToV","mol","ceil","pol","setQueryStringWithoutPageReload","qsValue","newurl","location","protocol","host","pathname","history","pushState","path","setQueryStringValue","key","queryString","search","values","parse","newQsValue","stringify","getQueryStringValue","handleMouse","graphs","nx","ny","scroll","redraw","transIndex","EditorFrag","useMonaco","wsize","windowSize","setWindowSize","handleResize","innerWidth","innerHeight","useWindowSize","astate","setAstate","code","widgets","isComputed","version","setting","setSetting","currentVersion","waveformCanvasRef","waveformState","loudness","opacity","g","ReDrawBuffer","codeResult","refreshIsPossible","setRefreshIsPossible","computeTime","setComputeTime","waitingForWorker","setWaiting","loadPreset","preset","compressedB64ToObj","getData","getInitialData","testSetting","res","isEqual","valid","old","test","dimOld","gainNode","N","audioCtx","waveArray","pow","gain","setValueCurveAtTime","currentTime","source","exportedWav","setExportedWav","exportWav","samples","b64file","compute","saveSetting","settingClone","Object","keys","forEach","objToCompressedB64","DURATION","performance","now","clone","computeSetting","setTimeout","createBuffer","channel","nowBuffering","createBufferSource","createGain","connect","destination","play","webkitAudioContext","background","margin","marginRight","marginTop","href","download","textDecoration","alignItems","tuto","flexWrap","overflowY","obj","newGrid","minWidth","defaultLanguage","defaultValue","theme","options","bottom","right","onContextMenu","preventDefault","button","App","className","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.08b849aa.chunk.js","sourcesContent":["var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!/home/ctrl/prog/natify/node_modules/comlink-loader/dist/comlink-worker-loader.js!/home/ctrl/prog/natify/node_modules/react-scripts/node_modules/babel-loader/lib/index.js??ref--5-oneOf-2!/home/ctrl/prog/natify/src/frag/Compute.js\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"e8be281791b297cd80be.worker.js\");\n};","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import React, { useCallback, useEffect, useRef, useState } from \"react\";\nexport let clamp = (x, a, b) => Math.max(a, Math.min(b, x));\nexport let flatstep = (a, b, x) => clamp((x - a) / (b - a), 0, 1);\nexport let ease = (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\nexport let smoothstep = (a, b, x) => ease(flatstep(a, b, x));\nexport let mix = (a, b, m) => a * (1.0 - m) + b * m;\nexport const useAnimationFrame = (callback) => {\n  // Use useRef for mutable variables that we want to persist\n  // without triggering a re-render on their change\n  const requestRef = React.useRef();\n  const previousTimeRef = React.useRef();\n\n  const animate = (time) => {\n    if (previousTimeRef.current != undefined) {\n      const deltaTime = time - previousTimeRef.current;\n      callback(deltaTime);\n    }\n    previousTimeRef.current = time;\n    requestRef.current = requestAnimationFrame(animate);\n  };\n\n  React.useEffect(() => {\n    requestRef.current = requestAnimationFrame(animate);\n    return () => cancelAnimationFrame(requestRef.current);\n  }, []); // Make sure the effect runs only once\n};\n\nexport function useWindowSize() {\n  // Initialize state with undefined width/height so server and client renders match\n  // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n  const [windowSize, setWindowSize] = useState({\n    width: undefined,\n    height: undefined,\n  });\n\n  useEffect(() => {\n    // Handler to call on window resize\n    function handleResize() {\n      // Set window width/height to state\n      setWindowSize({\n        width: window.innerWidth,\n        height: window.innerHeight,\n      });\n    }\n\n    // Add event listener\n    window.addEventListener(\"resize\", handleResize);\n\n    // Call handler right away so state gets updated with initial window size\n    handleResize();\n\n    // Remove event listener on cleanup\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []); // Empty array ensures that effect is only run on mount\n\n  return windowSize;\n}\n","let clamp = (x, a, b) => Math.max(a, Math.min(b, x));\nlet flatstep = (a, b, x) => clamp((x - a) / (b - a), 0, 1);\nlet ease = (t) => (t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t);\nlet smoothstep = (a, b, x) => ease(flatstep(a, b, x));\nlet mix = (a, b, m) => a * (1.0 - m) + b * m;\n\n//Wrap {loop, clamp, zero}\nexport default class Interp {\n  constructor(arr, wrap = \"loop\") {\n    this.arr = arr;\n    this.wrap = wrap;\n  }\n\n  getWrap(i) {\n    if (i >= 0 && i < this.arr.length) {\n      return this.arr[i];\n    }\n\n    if (this.wrap === \"loop\") {\n      let i2 = i % this.arr.length;\n      if (i2 < 0) i2 += this.arr.length;\n      return this.arr[i2];\n    }\n\n    return i;\n  }\n\n  nearest(i) {\n    return this.arr[Math.round(i) % this.arr.length];\n  }\n\n  linear(i) {\n    let phase = i % 1;\n    let k = Math.floor(i);\n    return mix(this.getWrap(k), this.getWrap(k + 1), flatstep(0, 1, phase % 1));\n  }\n\n  smoothstep(i) {\n    let phase = i % 1;\n    let k = Math.floor(i);\n    return mix(\n      this.getWrap(k),\n      this.getWrap(k + 1),\n      smoothstep(0, 1, phase % 1)\n    );\n  }\n\n  getTangent(k) {\n    return (this.getWrap(k + 1) - this.getWrap(k - 1)) / 2;\n  }\n\n  cubic(t) {\n    const k = Math.floor(t);\n    const m = [this.getTangent(k), this.getTangent(k + 1)]; //get tangents\n    const p = [this.getWrap(k), this.getWrap(k + 1)]; //get points\n    //Translate t to interpolate between k and k+1\n    t -= k;\n    const t2 = t * t; //t^2\n    const t3 = t * t2; //t^3\n    //Apply cubic hermite spline formula\n    return (\n      (2 * t3 - 3 * t2 + 1) * p[0] +\n      (t3 - 2 * t2 + t) * m[0] +\n      (-2 * t3 + 3 * t2) * p[1] +\n      (t3 - t2) * m[1]\n    );\n  }\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport React from \"react\";\nimport { useAnimationFrame } from \"./utils\";\nimport Interp from \"./Interp\";\n\nvar cloneDeep = require(\"lodash.clonedeep\");\n\nexport default function Curve({ name, value, onChange }) {\n  let stateTemp = useRef();\n\n  let canvasRef = useRef();\n\n  let [toDisplay, setToDisplay] = useState([]);\n\n  useAnimationFrame((deltaTime) => {\n    setToDisplay(cloneDeep(stateTemp.current));\n\n    let canvas = canvasRef.current;\n    if (canvas) {\n      let a = stateTemp.current.arr;\n\n      let s = new Interp(a);\n      let ctx = canvas.getContext(\"2d\");\n      ctx.clearRect(0, 0, 100, 100);\n      ctx.fillStyle = \"#3dc9b0\";\n      ctx.fillRect(0, 0, 100, 100);\n      ctx.beginPath();\n\n      function get(i) {\n        if (stateTemp.current.mode === \"nearest\") {\n          return s.nearest(i);\n        } else if (stateTemp.current.mode === \"linear\") {\n          return s.linear(i);\n        } else if (stateTemp.current.mode === \"smooth\") {\n          return s.smoothstep(i);\n        } else {\n          return s.cubic(i);\n        }\n      }\n\n      ctx.moveTo(0, 100 - get(0) * 100);\n      for (let i2 = 0; i2 < a.length * 100 * 1.5; i2++) {\n        let i = i2 / 100;\n        ctx.lineTo((100 * i) / (a.length - 1), 100 - get(i) * 100);\n      }\n      ctx.strokeStyle = \"#fff\";\n      ctx.stroke();\n      ctx.fillStyle = \"#569cd6\";\n      ctx.lineWidth = 2;\n      ctx.lineTo(100, 100);\n      ctx.lineTo(0, 100);\n      ctx.fill();\n    }\n  });\n\n  useEffect(() => {}, [toDisplay]);\n\n  let [drawing, setDrawing] = useState(false);\n\n  useEffect(() => {\n    window.addEventListener(\"mouseup\", () => setDrawing(false));\n  }, []);\n\n  useEffect(() => (stateTemp.current = value), [value]);\n\n  useEffect(() => {\n    if (!drawing) {\n      console.log(\"Curve: onChange \");\n      onChange(stateTemp.current);\n    }\n  }, [drawing]);\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n      <div\n        style={{\n          textAlign: \"left\",\n          color: \"grey\",\n          fontSize: \"0.7em\",\n          fontWeight: \"bold\",\n          display: \"flex\",\n          justifyContent: \"space-between\",\n        }}\n      >\n        <div style={{ border: \"1px solid rgba(0,0,0,0)\" }}>{name}</div>\n\n        <div\n          style={{ border: \"1px solid grey\", cursor: \"pointer\" }}\n          onClick={() => {\n            stateTemp.current.mode =\n              value.mode === \"linear\"\n                ? \"smooth\"\n                : value.mode === \"smooth\"\n                ? \"cubic\"\n                : value.mode === \"cubic\"\n                ? \"nearest\"\n                : \"linear\";\n            onChange(stateTemp.current);\n          }}\n        >\n          {value.mode}\n        </div>\n      </div>\n      <canvas\n        width={100}\n        height={100}\n        style={{ borderRadius: \"5px\", overflow: \"hidden\" }}\n        onMouseMove={(e) => {\n          if (drawing) {\n            var rect = e.target.getBoundingClientRect();\n            var x = e.clientX - rect.left; //x position within the element.\n            var y = e.clientY - rect.top; //y position within the element.\n            stateTemp.current.arr[Math.floor(x / 10)] = (100 - y) / 100.0;\n          }\n        }}\n        onMouseDown={(e) => {\n          var rect = e.target.getBoundingClientRect();\n          var x = e.clientX - rect.left; //x position within the element.\n          var y = e.clientY - rect.top; //y position within the element.\n          stateTemp.current.arr[Math.floor(x / 10)] = (100 - y) / 100.0;\n          setDrawing(true);\n        }}\n        ref={canvasRef}\n      ></canvas>\n    </div>\n  );\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport React from \"react\";\nvar cloneDeep = require(\"lodash.clonedeep\");\n\nexport default function Grid({ name, value, onChange }) {\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\" }}>\n      <div\n        style={{\n          textAlign: \"left\",\n          color: \"grey\",\n          fontSize: \"0.7em\",\n          fontWeight: \"bold\",\n        }}\n      >\n        {name}\n      </div>\n      {value.map((row, rowIndex) => (\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            width: row.length * 20 + \"px\",\n            height: \"20px\",\n          }}\n        >\n          {row.map((col, colIndex) => (\n            <div\n              style={{\n                width: \"20px\",\n                height: \"20px\",\n                backgroundColor: col ? \"rgb(100, 153, 211)\" : \"#465\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => {\n                let newVal = cloneDeep(value);\n                newVal[rowIndex][colIndex] = !newVal[rowIndex][colIndex];\n                onChange(newVal);\n              }}\n            ></div>\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport React from \"react\";\nimport { useAnimationFrame } from \"./utils\";\nimport Interp from \"./Interp\";\n\nvar cloneDeep = require(\"lodash.clonedeep\");\n\nasync function getMedia() {\n  try {\n    let stream = await navigator.mediaDevices.getUserMedia({\n      audio: true,\n    });\n    return stream;\n  } catch (e) {\n    console.error(\"getMedia: \", e);\n    return null;\n  }\n}\n\nfunction AudioBufferVisu({ audioBuffer }) {\n  let canvasRef = useRef();\n\n  useEffect(() => {\n    let canvas = canvasRef.current;\n    if (audioBuffer && canvas) {\n      let ctx = canvas.getContext(\"2d\");\n      let w = canvas.width;\n      let h = canvas.height;\n      ctx.fillStyle = \"#333\";\n      ctx.fillRect(0, 0, w, h);\n      ctx.beginPath();\n      let d = audioBuffer.getChannelData(0);\n      console.log(d);\n      function s2y(s) {\n        return h - h * (s * 0.5 + 0.5);\n      }\n      ctx.moveTo(0, s2y(d[0]));\n      for (let i = 0; i < d.length; i++) {\n        ctx.lineTo((w * i) / (d.length - 1), s2y(d[i]));\n      }\n      ctx.strokeStyle = \"#569cd6\";\n      ctx.stroke();\n    }\n  }, [audioBuffer]);\n\n  if (!audioBuffer) return <div></div>;\n\n  function fix(str) {\n    return (str + \"\").padEnd(7, \" \");\n  }\n\n  return (\n    <div>\n      <div style={{ whiteSpace: \"pre\" }}>\n        {fix(Math.floor(audioBuffer.duration * 1000) / 1000) + \" s\"}\n      </div>\n      <div style={{ whiteSpace: \"pre\" }}>\n        {fix(audioBuffer.length) + \" samples\"}\n      </div>\n      <div style={{ whiteSpace: \"pre\" }}>\n        {fix(audioBuffer.numberOfChannels) + \" channels\"}\n      </div>\n      <div style={{ whiteSpace: \"pre\" }}>\n        {fix(audioBuffer.sampleRate) + \" Hz\"}\n      </div>\n      <canvas width={110} height={30} ref={canvasRef}></canvas>\n    </div>\n  );\n}\n\nexport default function InSound({ name, value, onChange }) {\n  let [file, setFile] = useState();\n\n  useEffect(() => {\n    console.log(file);\n    if (file) convertBlobToAudioBuffer(file);\n  }, [file]);\n\n  let [recorderState, setRecorderState] = useState({\n    chunks: [],\n    stream: null,\n    mediaRecorder: null,\n    started: false,\n  });\n\n  let [audioBuffer, setAudioBuffer] = useState();\n\n  useEffect(() => {\n    if (audioBuffer) onChange(audioBuffer.getChannelData(0));\n  }, [audioBuffer]);\n\n  let startRecord = useCallback(async () => {\n    let { chunks, stream, mediaRecorder, started } = recorderState;\n    if (!stream) stream = await getMedia();\n    if (!mediaRecorder) mediaRecorder = new MediaRecorder(stream);\n    if (!started) {\n      chunks = [];\n      mediaRecorder.start();\n      mediaRecorder.ondataavailable = (e) => {\n        console.log(\"DATA AVAILABLE\");\n        convertBlobToAudioBuffer(e.data);\n        chunks.push(e.data);\n      };\n      started = true;\n    }\n    setRecorderState({ chunks, stream, mediaRecorder, started });\n  }, [recorderState]);\n\n  let stopRecord = useCallback(async () => {\n    let { chunks, stream, mediaRecorder, started } = recorderState;\n    if (stream && mediaRecorder && started) {\n      started = false;\n      mediaRecorder.stop();\n    }\n\n    setRecorderState({ chunks, stream, mediaRecorder, started });\n  }, [recorderState]);\n\n  function convertBlobToAudioBuffer(myBlob) {\n    const audioContext = new AudioContext();\n    const fileReader = new FileReader();\n    fileReader.onloadend = () => {\n      let myArrayBuffer = fileReader.result;\n      audioContext.decodeAudioData(myArrayBuffer, (audioBuffer) => {\n        setAudioBuffer(audioBuffer);\n      });\n    };\n    fileReader.readAsArrayBuffer(myBlob);\n  }\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        width: \"110px\",\n        height: \"110px\",\n        padding: \"5px\",\n      }}\n    >\n      <div\n        style={{\n          textAlign: \"left\",\n          color: \"grey\",\n          fontSize: \"0.7em\",\n          fontWeight: \"bold\",\n          display: \"flex\",\n          flexDirection: \"column\",\n        }}\n      >\n        <div style={{ border: \"1px solid rgba(0,0,0,0)\" }}>{name}</div>\n\n        <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\n          {!recorderState.started && (\n            <div\n              onClick={() => startRecord()}\n              style={{\n                border: \"1px solid #3dc9b0\",\n                cursor: \"pointer\",\n                flex: \"1 1 auto\",\n                textAlign: \"center\",\n                color: \"#3dc9b0\",\n              }}\n            >\n              rec\n            </div>\n          )}\n          {recorderState.started && (\n            <div\n              onClick={() => stopRecord()}\n              style={{\n                border: \"1px solid #569cd6\",\n                cursor: \"pointer\",\n                flex: \"1 1 auto\",\n                textAlign: \"center\",\n                color: \"#569cd6\",\n              }}\n            >\n              stop\n              <span\n                style={{\n                  marginLeft: \"5px\",\n                  marginBottom: \"1px\",\n                  display: \"inline-block\",\n                  borderRadius: \"50%\",\n                  width: \"5px\",\n                  height: \"5px\",\n                  backgroundColor: \"red\",\n                }}\n              ></span>\n            </div>\n          )}\n          {!recorderState.started && (\n            <>\n              {\" \"}\n              <label\n                for={\"file\" + name}\n                style={{\n                  flex: \"1 1 auto\",\n                  border: \"1px solid #3dc9b0\",\n                  cursor: \"pointer\",\n                  borderLeft: \"none\",\n                  // borderRight: \"none\",\n                  textAlign: \"center\",\n                  color: \"#3dc9b0\",\n                }}\n              >\n                file\n              </label>\n              <input\n                onChange={(e) => setFile(e.target.files[0])}\n                style={{ display: \"none\" }}\n                type=\"file\"\n                id={\"file\" + name}\n                name=\"file\"\n                multiple\n              ></input>{\" \"}\n              {/* <div\n                style={{\n                  border: \"1px solid #3dc9b0\",\n                  cursor: \"pointer\",\n                  flex: \"1 1 auto\",\n                  textAlign: \"center\",\n                  color: \"#3dc9b0\",\n                }}\n              >\n                link\n              </div> */}\n            </>\n          )}\n        </div>\n\n        <AudioBufferVisu audioBuffer={audioBuffer}></AudioBufferVisu>\n      </div>\n    </div>\n  );\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport React from \"react\";\n\nfunction polarToCartesian(centerX, centerY, radius, angle) {\n  return {\n    x: centerX + radius * Math.cos(angle),\n    y: centerY + radius * Math.sin(angle),\n  };\n}\n\nfunction describeArc(x, y, radius, startAngle, endAngle) {\n  var start = polarToCartesian(x, y, radius, endAngle);\n  var end = polarToCartesian(x, y, radius, startAngle);\n\n  var largeArcFlag = endAngle - startAngle <= Math.PI ? \"0\" : \"1\";\n\n  var d = [\n    \"M\",\n    start.x,\n    start.y,\n    \"A\",\n    radius,\n    radius,\n    0,\n    largeArcFlag,\n    0,\n    end.x,\n    end.y,\n  ].join(\" \");\n\n  return d;\n}\n\nconst WIDTH = 120;\nconst WIDTH_HALF = WIDTH / 2.0;\n\nfunction SvgComponent({ angle }) {\n  let state = useMemo(() => {\n    let a2 = angle * 1.0001 + Math.PI / 2.0;\n    let arcpaths = [describeArc(90, 90, 70, Math.PI / 2.0, a2)];\n    if (a2 >= Math.PI * 2.5) {\n      arcpaths = [\n        describeArc(90, 90, 70, Math.PI / 2.0, Math.PI * 1.99 + Math.PI / 2.0),\n        describeArc(90, 90, 70, Math.PI / 2.0, a2 % (Math.PI * 2)),\n      ];\n    }\n\n    let cx = 90 + 70 * Math.cos(a2);\n    let cy = 90 + 70 * Math.sin(a2);\n\n    return {\n      arcpaths,\n      cx,\n      cy,\n    };\n  }, [angle]);\n\n  return (\n    <svg\n      width={WIDTH}\n      height={WIDTH}\n      viewBox=\"0 0 180 180\"\n      style={{\n        padding: 5,\n        boxSizing: \"border-box\",\n      }}\n    >\n      <defs>\n        <linearGradient id=\"prefix__svgya\" x1={0} x2={0} y1={0} y2={1}>\n          <stop offset=\"0%\" stopColor=\"rgb(96, 197, 177)\" />\n          <stop offset=\"100%\" stopColor=\"rgb(100, 153, 211)\" />\n        </linearGradient>\n      </defs>\n      <circle\n        r={70}\n        cx={90}\n        cy={90}\n        strokeWidth={5}\n        stroke=\"#333\"\n        fill=\"none\"\n      />\n\n      {state.arcpaths.map((d, index) => (\n        <path\n          d={d}\n          strokeLinecap=\"round\"\n          strokeWidth={20}\n          stroke=\"url(#prefix__svgya)\" //{index === 0 ? \"rgb(96, 197, 177)\" : \"#000000\"}\n          fill=\"none\"\n        />\n      ))}\n\n      <circle r={20} cx={state.cx} cy={state.cy} fill=\"#fff\" cursor=\"pointer\" />\n    </svg>\n  );\n}\n\nfunction format(step, value) {\n  if (Math.round(step) !== step) {\n    return Math.round(value * (1.0 / step)) / (1.0 / step) + \"\";\n  } else {\n    return Math.round(value) + \"\";\n  }\n}\n\nexport default function RSlider({\n  min,\n  max,\n  step,\n  value,\n  onChange,\n  maxTurn,\n  name,\n  unit,\n}) {\n  let angle = useMemo(() => (Math.PI * 2 * (value - min)) / (max - min));\n\n  let ref = useRef();\n\n  let mousemove = useCallback(\n    (event) => {\n      const rectSize = ref.current.getBoundingClientRect();\n      const width = rectSize.width;\n      let center = width / 2;\n      let relativeX = event.clientX - rectSize.left;\n      let relativeY = event.clientY - rectSize.top;\n      let angleBetweenTwoVectors = Math.atan2(\n        relativeY - center,\n        relativeX - center\n      );\n\n      angleBetweenTwoVectors =\n        (angleBetweenTwoVectors + Math.PI * 2 - Math.PI / 2) % (Math.PI * 2);\n      angleBetweenTwoVectors /= Math.PI * 2;\n\n      if (!isNaN(angleBetweenTwoVectors)) {\n        let newValue = min + (max - min) * angleBetweenTwoVectors;\n        newValue = Math.max(\n          min,\n          Math.min(max, Math.round(newValue / step) * step)\n        );\n        onChange(newValue);\n      }\n    },\n    [onChange, min, max, step]\n  );\n\n  let [clicked, setClicked] = useState(false);\n  let [hover, setHover] = useState(false);\n  useEffect(() => {\n    window.addEventListener(\"mouseup\", () => setClicked(false));\n  }, []);\n\n  useEffect(() => {\n    if (clicked) {\n      window.addEventListener(\"mousemove\", mousemove);\n      return () => window.removeEventListener(\"mousemove\", mousemove);\n    }\n  }, [clicked, mousemove]);\n\n  return (\n    <div\n      ref={ref}\n      style={{\n        userSelect: \"none\",\n        width: WIDTH + \"px\",\n        height: WIDTH + \"px\",\n        position: \"relative\",\n\n        backgroundColor: clicked\n          ? \"rgba(200,255,255,0.03)\"\n          : hover\n          ? \"rgba(200,255,255,0.03)\"\n          : \"rgba(0,0,0,0)\",\n        // border: \"1px solid #222\",\n        boxShadow: clicked ? \"rgba(0,0,0,0.3) 0px 0px 14px\" : \"none\",\n        transition: \"background-color 0ms, box-shadow 200ms \",\n        borderRadius: \"5px\",\n      }}\n      onMouseEnter={() => setHover(true)}\n      onMouseLeave={() => setHover(false)}\n      onMouseDown={(e) => {\n        setClicked(true);\n        mousemove(e);\n      }}\n    >\n      <SvgComponent angle={angle}></SvgComponent>\n      <div\n        style={{\n          position: \"absolute\",\n          top: \"50%\",\n          left: \"50%\",\n          transform: \"translate(-50%,-50%)\",\n        }}\n      >\n        <div style={{ fontSize: \"0.7em\", fontWeight: \"bold\", color: \"grey\" }}>\n          {name}\n        </div>\n        <div style={{ color: \"rgb(100, 153, 211)\" }}>\n          {format(step, value) + \" \" + unit}\n        </div>\n      </div>\n    </div>\n  );\n}\n","import Editor, { useMonaco } from \"@monaco-editor/react\";\n// eslint-disable-next-line\nimport MyWorker from \"comlink-loader!./Compute\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport Curve from \"./Curve\";\nimport Grid from \"./Grid\";\nimport InSound from \"./InSound\";\nimport RSlider from \"./RSlider\";\nimport { mix, smoothstep, useAnimationFrame, useWindowSize } from \"./utils\";\nconst qs = require(\"query-string\");\nvar cloneDeep = require(\"lodash.clonedeep\");\n\nvar _ = require(\"lodash\");\n\n// instantiate a new Worker with our code in it:\nconst worker = new MyWorker();\n\nconst tuto1 =\n  \"?data=eJxtkm9v2jAQxr%2FKya%2BAZvmztZqUjRdosIK0tqxQTVNTTSY5wJtjo9iBAsp335kkdOv2Jr6c7365e54cWaozZDELgmAoVsJyCUaXKgNh4GdpLHAwaEEvwfB8I9H4MGhCKHBToEFlTdPjXk1ZIHDXtxJbVGBFjn6iiD9GutnrElKuIMOlUPgPHeyaendCSlggbCTfYwYLnv4Cq11vok4ouJZ6waUBTsgYhg%2F3g%2Fnk7tYDOkfQubyMwnB98P2uB7PBzfTL6Menu4fbuQffJsPr0XzWYr6%2FniallXUORooMC1jsATNhhVrRXNg2w%2Br08ThRTcL%2FfD%2F62j%2FmQtEsV6EHOX%2BOgUag0FjcUDby3DIprrUkcAzv3F2phI0TNj4krHITSZKi1aEPj0%2BJWuoCOi9pyoYf2vjjX6u16YuLLhwTBRAETnmgmQymWmXGJR3qlO435YETrC6f1djcmU7aL9DukPx7EwEnayNX1Az3WJ9PRLnhdu0boTpOAujV8F6dnk6g99YPuzV%2BWp63SKU2pC45GrqH1Dv3RgJvtSxz%2FM%2BXerS4%2Fz5RJFOBtixUW8A8thPZCq1h8ZG1%2F4GLyQ0Wh37kMXKDxVHoMedFk3PS01%2Fv%2Bv%2Fwhco8tuWyRFd2VXnMrXWmkbUtLDzjXmDjw2uac7nlUVxV1W8WoxpF\";\nconst tuto2 =\n  \"?data=eJy1lH1v2jAQxr%2FKyX8lkCZOCKTJ2k1Rmw20vq1QTVNTVSm4JVpwImJaVMR33zlvsI52laYhQY6zn99zOp%2BzIuN0wohHDMOYCpHlnmEwrj%2FFP%2BOMTeJIT%2BcPhvxnBPyRJWnGbpXZIo%2FHashD%2Fn1w%2FCUYDfXPl8E3OIQVzGLuQZdqMIuWHpiUYpgLlmGswYLHwoOQ9J9DAuuN2h%2BN%2FKOvGz3VqVkRqG7WgDJbM%2FLfEcfBkf%2FjnwjDq%2BHIH5ztZLyPcBmcBP4weKUK601GyA3jNBJT6LMkY3O4X%2FCxiFOehzxhAsZJNMsQrCw1iDS4U%2BHwI8j9OtIVzJRxzJU7DZaqWqruk0hITymUKrkkhQVNUZawB5EKBih3RaQBHpZZaVmUM6kThULAAehd%2BAQWtPCP%2FHqwZ0IbFBu1RVaVP6U4n6WpmO6yllilrqtZKWapEGJhCctRdX0T8vt0DsomjVn6oY4PYOifXpwEt0fnV2ejOt1uq7AKOeBH6kQ8k6pKYsClPwrK1crounze4Kaigzl2sJjlVqltlemLAUaWTos6pdxobgPs5rUOt5qgYF%2FLGdcKrPqqxtQpthOHBf229LW4uihtKMb9b7A%2FALUQn%2FW0t6Ga2pfwzZ7G5lUjqjshxyGeM7GY83oH0chTPHlgIifeihxfYfMH52cyxjklnryXBKeXeCbViKyyysmbge8jqc%2BSaMymaTJhc9ymkccoWeC7ylxrRJ5Sw8IXTo2iDWyD6j%2B%2FZFlWR%2B%2FRnuM6ju26zr7rNHC700V82YytYmldbVFjXS59o15c7Zg9y3KcXo%2Bavf2O4zYmuGahS9Hp%2F2nioEl1jLts3m1ibkFNG6HV1Oyu3Xp37bbtWGan63bxFNyu49rbPuv1%2BhfpTuiG\";\nconst tuto3 =\n  \"?data=eJyNVn9P20gQ%2FSojSyeti3EcJ8ZNKD0hCCW6Aj0S7v4gqNokm8Q6x3btDaRF%2Be43s%2Bu1TYDTIZHsj3nvjd%2FMevNszdK5sPrW38PzL4PxyP3r5uvd1QBO4BnWUdIHz4E13%2Fah7UAhRYYLLg43SST7MLEmFuwmicGejv9oAF2vXWJxGNRwz2sQFC8ZzgejsyaFYfAb8PfRF7eDP2t0UKX%2B0fNKfNurwZe%2FXqIvT2%2Bvbq6Htb4RD434uw8%2BvK5RRrXbNCyL%2BUys0ngu8r6%2FzzJJWq0rLldwKeJM5LDYJDMZpUkxSWIhYRbzdYb0bOsAd2Bqw8lnoHgXdRiu6HGUsKkDW9vWqEXMJekTkFC0RUDFxtgWDoHb0AI2VSOHCt0usYIXgnBSISR8AjeA38GHDzih%2Fz4ctuEAWBexatWmDw0u1mkqV29JEy0zeVU7peY62tbxaxXPkZS1XQ9FcOEApjhfH5Nbo3STzGH0M5ErUUTFvmPZJlf5L3LxwwFZG1agSbRYPgilrta%2FDcssZB7xZBm%2FjebTgrEaf4iV9QMbfgPMkQzwVar7k9KVHxv%2BOikjVy9%2Bpg5Hr%2BmxyeUKz5%2F2wXUmjQyUpoZw%2BQ9B5ia%2BLgzDWqtlHTgXs9r6xvOKbcYOO8YjajbEyb3GKTmeVpEUSRrpxqk5cp7M0zXbc8RUMMvTmSiwKsv9EubiUeRT4ppuFguROxDzpaLVc3eR5gM%2BWzEmHIgcSgn3IvQP49A%2Ffh89wMEJfaMorj1gBp7bRVO9MuUiWmexuLgY1yqK5HmSAOrLTZ5AIp5gsZDuWUqx29M85z%2FLWDcWyVKubDQGz9Mjjzc6k6QmAVDLbi54jCIah4kd0%2BbOdlGbYTI7U2LSKDBQy4xOr759HXw%2Fu7m7HmMUPjAwE4dB3rEefYJmoF48OLB1BqqnMVhFtuD2dDw4NuukhM2m5or8kefooGKOkNa8D3FW8WmkarwTUK%2Fbsjuy9InhWxAdsOu4YsUz6gc6j1Xr1tv0vJHczCmkIvHcoCYpVAmrsA%2BaUblHH6Vj9%2FT9QFUsMATbnuFF5OiXEva2ntHNUq7pK04b32rpTmMll0OH2sMgssq8ShfyO3lo%2BsXEUumXiUqN2W4RRzNBJ6RZDvTcR5aym54bSTs0XuY8WxV9uDeLJPWAiVmO9RTNl0IWVv%2FZOr%2FDbIY31zTG97zVpyvFwgNp0YVm0ZEu1%2Bhiwcu8QHzjysEwx1KtiKOdY2kDajbD9RbV%2B0yee%2BS9%2BCNq9LqRpWfSVL8AKnb6BfBuqrjt%2B50j7yjshWG31ws%2F9sKG5utNVKXivmGO35D8T8VuN%2FTbnaAXIGUvCHsNvf0tVKO%2Br9SCyj36lVHqUVVKtctf%2B3IdijPV6IQeMpqjVrGaJwgrxncL4rtH3SAM2p1228NRz6vder2FWnhKX1W%2B%2B38q79e8u93uXw7N8Ns%3D\";\nconst tuto4 =\n  \"?data=eJyNVX9P20gQ%2FSojSyetiTG2Y%2BPalFZRSY%2FoCrQE7v4gqNokhljn2MbelADKd%2B%2FMrn8RyOkigXdn5703OzO7%2B6LNsnmkhdo%2Fo5M%2Fh1dj8%2B%2BLb9dnQziGF1jGaQiWAUu%2BDsE2oBRRjgYTh6s0FiFMtIkGm0laYwdXf3WApmVXWBx6LdyyOgTla4aT4fhLl6JmcDrw3eivl8MfLdprQv9gWRXetlrw6fNr9Ong8uzifNTq1%2BJ%2BLb5z46PzFlWrut2E5QmfRYssmUdF6GyzTNKDgzMuFnAaJXlUwN0qnYk4S8tJmkQCZglf5kjP1gZwA6Y6HH8C8jdRh6FFjeOUTQ1Y67pC3SVckD4BCUVLBJRsjK1hH7gOB8CmcmRQoe0KG%2FEyIpyQCAEfwfTgMziwhxP6C2Hfhh4wF7HSqtM%2FBS6XWSYW70kTLavjalYqzWW8bv2X0p8jKbNNC0XQ0IMpzpdHlK1xtkrnMH5KxSIq43I7Y%2FmqkPHfFdGDAaJNWIlJImO1EQpd2r%2BPqihEEfP0PnkfzaclYy1%2BHyvreDr8ARgjJcCRoW5Pqqw8rPjboGq51viJOhxzTdumLDd4%2FrgNbiPpRCA1FYSLfwkyr%2F3bwjCstTQrx3k0a1Pf2W%2B0ztl%2Bv84RNRvixFbjVBwFf0wzITdI35Ykzx6ZYxrKjIjAJLDt6NT3amfLPIlKRA6Kgj%2Bx8eDs%2B7fhzy8X1%2BdX6HSXFcBqP3SyjtToI3QdlbHX0%2BFlkgLIUqKz9DyAy8HV8Ki2kxLmuJkXci6nN7g%2FR54EV50H59ZE%2FSGfLRhL5Z4kPYCM6hcvIFYhxRhPfX%2FgrAmEfvI0UqmO6ywR1x7I22qvzRJeIgbEehdWLnhOOaWGbmrfdaDcxWI1J6eGyDK9LlEBveOO455iVasb9SnJpcAl7BmGt7ihTjQ2hprRtdxKYwtQymxPTWUCabiR61U9b%2Bh7S%2F1QIpN6VXAdBYtIrIpU5adyNmh8X%2FB8UYZwUxlv0VsztMd4fh%2BJUgtftJNrrOTo4pzGeN9pIV2tGjamRhe7Rq1d2eiCxUetRHzn6kU3Q%2FvFkxU%2BeLYZWK9%2B9sbQVJgtfU3%2BHvduass8fEuNeeyEbdVxy6exYaencWfsuOw4%2FUPr0A983w0C%2F0PgdzTfLqIqFe6dbDkdyf9UdF3fsfte4CFl4PlBR297CdWooxs1r8kePb%2BVHpWpUjt93pbrk1%2FFj2MkrI9UQ1pvwG8Id9bDMQ9dz%2Ffsvm1bOAqsNlkuUuNpe1Nn9%2F%2FU2WlonM1m8xuqgJbq\";\nconst tuto5 =\n  \"?data=eJydVmFP4zgQ%2FSujSLdKaUiTtKHbsuwJQe%2BobqEchbsPFJ1M65Lo0iSbuEtZ1P9%2BM3acpKVF6CoRnPG8N%2BM3YzuvxjSZcaNv%2FD08%2F31wO7b%2FGn27uxzACbzCIoz74FiwYKs%2BuBbkgqdosHG4jEPRh4kxMWA9iTX29PaPGtB23AKLQ7%2BCO06NIN9kOB%2BMz%2BoUmsGrwfejf7sZ%2FFmh%2FTL1z45T4F2nAl%2F83ERfnN5cjq6GVXwdvKuD71348KpC6aidumBpxKY8SKIZz%2FrePpbx9elZpbwSrdCvvbH%2BOttGObb0uBrdDsaS8DmciQAXgMkFPHwKBPThCNYAMIkncat1yUQAFzxKeQbzZTwVYRLnkzjiAqYRW6RIYq4sYBY8NuDkK5C%2FjbmZaFHjMDYfLVg1Ggo1j5igjAlIKJoioGQzzRUcAmtAC8xHObKoz9wCy1nOCSckQsAXsH34FTw4wBf668OhC00wO4iV1gY9FDhfJIkIdoUmWlPnVc4UMRfhqvJfSH%2BGpKZrOxgEDU14xPfFMak1TpbxDMYvsQh4HubbiqXLTOY%2Fz%2Fh3C0QlWI4ikbFYCKUu7dfDIguRhSx%2Binaj2WNumhX%2BEHvB8xvwC2COJIAnU91%2BKVT5vmRvk9LhKuNXajDUmpZNKpd49rwNrjKpZSBjKggT%2FxJkpv2rwphYa2lWjjM%2BraSvrZevUvPQ1xpRsyFObDVOwZGx5zgRcoH0vyJJk2fTsy1lRkTPJrDrNajv1coWacRzRN4%2FKMtTxtJAvc6TDEzthS7OsRp9gfHp5fW3wT9no7urW2VsNhvwOokBZCHRWXq24Ob0dnCs7RQHFS7fM%2FleTYeLZSRYzJOl9CS73MQ2ZjJg08A0s%2BTZAnwM4xlXfS2DKnwaimmAQIWJePyE2%2FqwdFeO%2BFbRTZPIAny8oVOEyXyec1qMdsFyyGNKO%2BmFtmiZGEoBjvV0qzWKoxdEL9Il6p%2FLjSMChksVLBN8BgwNAcsB6wMvdHCEcZgHfKYZwjlQkvDpEwjsTvkf9aeLAvUG7Ua%2FunrNE7eakmX8wTIIVQ1DJNCnPb6VldM%2FeYBRd5%2FoxjKlstTj8o45qJoLj34LwsY2PA9YSu1IZ0G5bbadqPVCsZyRY0no2P42YQbNk5rzgWKvPNbVMCfXDF1w%2B5l4H1vqcMQ9pt5It81UMt1oNaa1nFdPuR3uqcYPJxsS02Sxe9Q0tQLGKr4gJjGSZVwss1ipW%2FhaJWneh3ttlAbccWvDMvCyeuIiN%2Fqvxvkd9tVwdEVjvGIMed0ZeBYYdJUbdJoUNroC8TMmR3ztekQ3y%2FjBoiV%2B4rh2x9n4uWvLUMlW9Jp8F%2Fd%2BasfuIBcKXMvT0YnKi7yko6%2BfvcnitOe1j5yjbq%2Fb7fR63c%2B9bi3I20mMShXdIY9XC%2FluxE6n67ltv%2BcjZc%2Fv9uqL2prCaNT%2BZTS%2FlIu%2BsIp4VJci2sXP7XBt8iv4cYyEeh%2BWpHoB3ZJwbwE8%2B6jjd3237boOjnpOJdbbKYyFe%2FVNpTsfqbRX8SKNPADrlfbLSrc%2Fqnq9d6gP5YlNnPJLTamovtSM%2FlHpe38%2FZ1HOrX1PkS33mR%2BsvdgaajfBTuw7sd7B7kHtdimxH0DtSvr%2FwJRYD%2Bv1%2Bj%2FwVtj%2F\";\nconst tuto6 =\n  \"?data=eJy9WgtT20gS%2FitTqroq2ShCki0beQM5JyiB2gA5ILmrAjYl22OsO1tyJBmcEP77dc9DGr0gm9sLlQWNpvvr5%2FRMj%2FZBm8Yzqo20fx4fvvMvL8xPZ%2B8%2FnvhknzyQVRiNiGWQVbAdEdsgaUbX8MKEx00UZiNyrV1r5PE6krzjy98VRtOyBS88ugW7ZSkAaRnh0L94o0JIBEdhb%2Bc%2BOT79%2FPbc%2F0eB4Obq71mWxLCtAuHoWwVi%2FK%2F%2FFQLZP598fN9kR6%2FZjm0Z4Wh8fnJ2eqx4QvLbeRhag4BO%2BDQ%2Br0dwT2FdL4MpXcTLGU0YQQsUOOPPQQ3aoC4%2BjN%2F4Lcnhlp1S1s1sD%2Ffp2aV%2FUfeRY7Vp57Zq5%2FuHCpBl5THvWa1otmO1BuH49OLy%2FGPDKrL%2FdBA4lG0xsOzrmiLJdJPc0Uqw%2FMvxe9tWfVxfurgOK%2F4dtgk%2B9P0PP4FX88l1tLt7HkSzeEUWdLmmCZlvomkWxlF6HclHks6nPUcPDDIxyNQgsw55uI4I%2FCQ02yRRzkP0fAZ%2FAnJwcLBPrN%2FIJH%2Ba5k8z%2BVQw3AUJycAoPSA7ZNIh30uzAcxMyB8cjHjKzARmpsCiT8nLl6RXZZwiJJtybJhiKkC0OwrJDEhmgGBXWFGbDN7PGiBRYlZ5LxyiZ0yG1SG7pO94fW8wdLyBoAO3wz%2B0NaUUBbMM%2F4NY20N%2FfPja99%2F%2BxqcTCAxMc%2B9bW8%2FvDYfea88ASqffezsY7%2B3h8%2Buhb7v2AMsw4KFV8zghOiKEhLk6JC%2BJ7cLfnZ0OQ9WRanf3JMgW5KgW9yXNyHQZrNbot61BMPAdsn9AkN6ENMNU4M9hpENObDsdzjVfBhmmH4shS5ctY2Rour4lL0iAPtEn7MnAlWULXhqkFPkyxpGByqZLXhGHdGGA%2F43ICxuD3Ade9raDvzhzuorjbNEkGmF1qVc%2BI2Suwm1Bv2L0AYDqtmmBEHgBaQjjFfPWRbyBeFx8jbIFTcO06rH1JmH6zxP6xSBZ4bAUnIQvhSGoOnv%2F4VhokSVhEN0um7mDSarrBf8OVgW3Q%2F5GQEd0gMNUrQ6EV75sgrpSUlzx8gCrBfgazUYv5%2FzBfZW50ETRgMnkLEH2H2SZSfoiMDrEmr3mhDM6LVyv2Eu3a%2F1FT%2FoIkw34skriCIwkuI%2FijBmIfwuQdXyvO1AS2Wvg8Exktp2OtItVmTuoj0m8jhOMopKndyC9mDDAIUWWRkF4R9%2FEq3VC0xSWGcBMNvM5TRi%2FKH4stQJMLT5nJnS2mVJdr6%2BkPMa4GvLBpIMmstLGAWBF%2B8F0oevUIKGBvsBUvQpvQIY4FXYJBRsBs8PqC1f3dhNmQQJKrmgWLCPQed8yB8aM0jUbYAhlVGUYFCPQPosPlbrO4iwTowsLdtfBhNTtTpkG12Ip%2Fpbp7FjmXjdfjiAeXlpGrh04ISAVmBRg8oW07oq103UUsmRnP82L65PaZq2a5kpZBqr103p0YYF2pYNLSj2h1RMe%2FAv16jfr9YRa%2FV%2BhltOslthLE6AYuC%2BArK8k9n2YLY6CZBVH4RQl6WkExWUh36iJLPfkhhxvyHP8ado%2F8%2F1ONgCKNHNJo9ts0RE7rAIuBaDsz%2Bg1Xj1zTljB5rxOni6CNZY1MIqp%2FZnXzSoZFKtlmG1mSFqChIkydUJ29hXyLpdQ0DwqQRFuVw8r0uPvWDkR7maOLMWBBYHzXeHObmBvCG1V38DjPfQfcJ6FIwucYLBHs%2B0bKIFrnVYCIhR4IPMRQVWhCcGTmYH6s5ZEbg5Y5bGaEaj8woBHrJuKvnF0%2B4u17UERdkr6DntlhXs1haW6H%2BJ75xeqW2yVqFGu755d1rfvtir8mi6Xv1BhmATHdtghqNcrudU2PU%2BxQlW%2FVfsLfgxglQP3%2B%2BKAk59egkyXaxDfCboC4lO83KxojnLHhg04CgZozckwUWWypuykL5TS8SgJHjGx7oZzosuOdX8frS9oMV8YcZ3OUemKkJS5ZHQKbzM3q0vt0ahMutjSqAR8%2FqauQu%2F%2FpQJbYj%2BkQv%2FXeMF5VknnKS1dqaU8mdcoBs12SPrnLXg%2BkE8pOFTFY01tSbo9lQ5rQwudV8Jje4qkrCe8JYmbNnBRHeQ9jHlLM7XXsi2CJytsuqBFEceHqgC7TUBJBD9J6%2BImxyD8BqbDeTJ55t7tdq%2BjLvHvguUmgNYjZT0jaxawPYzncE5iPUmA56xb6CUikoVYC7rk7%2BsgCVbk4WzybzrNHonoXfCPOh1tVhOa8GlzHWbTBRDxv2FEjr6ZrcQpGJBdgjRgYM9MNHKldBpHs7SdlR9wgG%2B2SQJ21fMMV8bFTDdJQqNGQbvKBRMFf52CHNavGYy6o%2FYh7BqGI5Yt4SQYUbwwsMj370B7QNhVNW%2BHu6oBndq%2BIi9v5CkQK7Xi2S6RN8bFCUwekGASul19fPm7KOvQ0vKREK8I5tyPeI3wjkY0wdzA6ZRkC0gFnia3cTwjWQw5vKCJ4p1bwYEeSvWSY9ZxmoaTJT3Z4D6sFABbWe6O8txTn1mJKsZ9GKvzvEKUx%2Br8AMauMh7CeKCM92A8vOHjsqLKyEyXIbTG4mYcemB%2Br92p2%2FieeRIP%2B1f8LNG%2FqRNdrINpyA59DUTc4%2FtknCTBV51dUStyiuWRNwOsEcA5pRFgbPWTPkugVdW6K3YQmS%2FjONH5xRveLSjWi7y8URKTgwjqA7b%2FvOJvR%2ByGZpcNypKXQYprJMQyR%2FBWlbwqNwDM9Cs2fyNye1Sm4L3alyTT8%2B8scL4SX22qDSAD2OdiuxV9cDVyggOSQ8HC5O9eFphlmEazeNnZr%2BbAk24VNA2uZVHOE6SSMk9iCpoGTOHYG3YXzwwyikwypAVKf1WkGbRkUpsuYR9hmvpfJiDvwmQKV2rCdQR1NY2XUG%2FiW%2F1aY0l6rRmcPr%2F2ggZQWQAX45MP7%2F3Pb84%2Bnl52xK2xpOP5zp5eEpWQv1SSX9ZnRrtLzseXvlJT02IxpWiwsEY6gx35I3ZPm28BWCuVfKtfnvGvAwKU23SFfzEG3FOVWzpdUHXyw%2Fa7JFhjXl3dKHbjIsfvS5a8Mrds%2FtxgbYj3iTBrWsX7O7F%2F2AY7fAykikKcud6kC%2F2O7wOyrSlZIWrnLVKnI3IlX%2BcQoO2jZmj34Qw2iVQbPWiHH8Hhx2en%2BLwKI22EH3m0VbDVRtBVaXhDI97hhx9tpKXAr3wVAjJDw9MK1UY9s2eVfnqPhsZvFwt4Cd6E3Q5tmR5gweao6GlJRdmnqhwOP0G3KgvTjtMbWIOhNxz2PW%2B45w0VIZZdscAGqbgbN7jHUUQ%2BKbHfHzp2z%2FVckOe5Q0%2BRNxgCvqxnuQw3dxJ%2BlRZSMBpCxtG3qhD8kilR7b6FoKJw%2FkWggwGCyrNMgzd6jd7Y1r3h9odDx3HdoWu59mDgFHqDAHk3lgvIczHPl%2FZsgfRDwP7Qs3qu28%2BBpY%2FhVFBLw73nYQsnSL%2F%2BJNCg8CYAsXrdnM3uj2aWuj7Qfaxq13znWM%2Fr5uZILurm%2B4cFDH4xF1HoWT%2BAxb6d51F12Bri%2FVK9CvxAWJXMtnIk20Is%2FGIOHOyDuZaTPWhBAnxXuNZdvFyG6oB5h7%2F73g%2F87g%2FcgePegI78f5%2BZbibhVHvE6PPu7alqhqWozRJTrTVDl9UW7AJ%2FGq%2BcAIB3R5MUjvywGDyoM2GKe9gmozNtNA%2BWKWXkIYyyZEMf%2FwtPrUHA\";\nconst tuto7 =\n  \"?data=eJx9kUFLw0AQhf%2FKMCelS0niyVUPpS0S0FZsi4ckSGimbSDZhN1NVdL8dyc1TaGoe9nh7ffeDLM1rouEUOKbP3mcLhdDf7aYr2YTeIAa7FdJEkI0RaWSEKEJ1QXm%2FcWFKiMLJs7LjAxDQRSqTaHh6iyz6tyd6ntYjJ5fnqbvY45dnuTB4BrqUAGfLir4uSM2dyP0yuEAzu%2FsoIe9C5on1WQrraDuTAK2Oi53RkJwUjqv6EOiBgV%2BpMmWrEFZ42T1Olr681lb56lC6QxdgXn8idJ1BBpLZadVKrW8bMP%2BMovXtCuyhDRjAvdxVvFHuI3Ark8b1662NbSbxR4KojPl%2FYsxtydt0oKncm9uj09pgtLqigSmZlzkZWWJlU2cGWq%2BAbM7qYk%3D\";\n//ADD MOUSE DRAWING WIDGET FOR REPLACING PURE SIN WITH OTHER PERIODIC FUNCTION\n//ADD SELECT WIDGET\n\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Array} buffer\n */\nfunction drawBuffer(canvas, buffers, dstate) {\n  let ctx = canvas.getContext(\"2d\");\n\n  for (let bufferIndex = 0; bufferIndex < buffers.length; bufferIndex++) {\n    let buffer = buffers[bufferIndex];\n    let h = canvas.height;\n    let w = canvas.width / buffers.length;\n\n    ctx.resetTransform();\n    ctx.translate(bufferIndex * w, 0.0);\n\n    let scale = 1;\n    if (dstate.trans) {\n      let t = dstate.trans[bufferIndex];\n      if (t && false) {\n        scale = t.scale;\n        ctx.translate(t.x, t.y);\n        ctx.scale(scale, scale);\n        ctx.translate(-t.x, -t.y);\n      }\n    } else {\n      console.log(\"no dstate\");\n    }\n\n    ctx.width = w;\n    ctx.height = h;\n\n    ctx.clearRect(0, 0, w, h);\n\n    if (\n      buffer === undefined ||\n      (!Array.isArray(buffer) && buffer.constructor !== Float32Array) ||\n      buffer.length < 2\n    ) {\n      ctx.fillStyle = \"rgb(30,70,70)\";\n      ctx.fillRect(0, 0, w, h);\n\n      ctx.fillStyle = \"rgb(70,0,0)\";\n      ctx.fillRect(1, 1, w - 1, h - 1);\n      continue;\n    } else {\n      ctx.fillStyle = \"rgb(30,30,30)\";\n      ctx.fillRect(0, 0, w, h);\n      ctx.fillStyle = \"rgb(30,70,70)\";\n      if (bufferIndex < buffers.length - 1) ctx.fillRect(w - 1, 0, 1, h);\n    }\n\n    let minY = buffer.reduce((prev, curr) => (curr < prev ? curr : prev));\n    let maxY = buffer.reduce((prev, curr) => (curr > prev ? curr : prev));\n    let split = maxY - minY;\n\n    maxY += split * 0.1;\n    minY -= split * 0.1;\n\n    function vToH(v) {\n      return h - ((v - minY) / (maxY - minY)) * h;\n    }\n    function iToV(i) {\n      return 10 + (i / (buffer.length - 1)) * (w - 20);\n    }\n    ctx.strokeStyle = \"#977\";\n    ctx.lineWidth = 1 / scale;\n    ctx.beginPath();\n    ctx.moveTo(0, vToH(0));\n    ctx.lineTo(w, vToH(0));\n\n    let mol = Math.ceil(vToH(-1)) + 0.5;\n    ctx.moveTo(0, mol);\n    ctx.lineTo(w, mol);\n\n    let pol = Math.floor(vToH(1)) - 0.5;\n    ctx.moveTo(0, pol);\n    ctx.lineTo(w, pol);\n    ctx.stroke();\n\n    ctx.beginPath();\n    ctx.moveTo(iToV(0), vToH(buffer[0]));\n    for (var i = 0; i < buffer.length; i++) {\n      let v = buffer[i];\n      ctx.lineTo(iToV(i), vToH(v));\n    }\n\n    ctx.strokeStyle =\n      bufferIndex % 2 === 0 ? \"rgb(96, 197, 177)\" : \"rgb(100, 153, 211)\";\n    ctx.lineWidth = 1 / scale;\n    ctx.stroke();\n  }\n}\n\nfunction hashCode(s) {\n  return s.split(\"\").reduce(function (a, b) {\n    a = (a << 5) - a + b.charCodeAt(0);\n    return a & a;\n  }, 0);\n}\n\nconst setQueryStringWithoutPageReload = (qsValue) => {\n  const newurl =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    qsValue;\n\n  window.history.pushState({ path: newurl }, \"\", newurl);\n};\n\nconst setQueryStringValue = (\n  key,\n  value,\n  queryString = window.location.search\n) => {\n  const values = qs.parse(queryString);\n  const newQsValue = qs.stringify({ ...values, [key]: value });\n  setQueryStringWithoutPageReload(`?${newQsValue}`);\n};\n\nexport const getQueryStringValue = (\n  key,\n  queryString = window.location.search\n) => {\n  const values = qs.parse(queryString);\n  return values[key];\n};\n\nfunction handleMouse(dstate, graphs, w, h, nx, ny, scroll) {\n  let redraw = false;\n  if (!dstate.trans || dstate.trans.length !== graphs.length) {\n    dstate.trans = [];\n    for (let i = 0; i < graphs.length; i++) {\n      dstate.trans.push({ scale: 1, x: w / 2, y: h / 2 });\n    }\n  }\n\n  if (nx != null && ny != null) {\n    dstate.x = nx;\n    dstate.y = ny;\n  }\n\n  if (scroll != null) {\n    redraw = true;\n    let transIndex = Math.floor((graphs.length * dstate.x) / w);\n    let t = dstate.trans[transIndex];\n\n    t.x = dstate.x;\n    t.y = dstate.y;\n\n    t.scale *= 1 + scroll * 0.2;\n    t.scale = Math.max(1, t.scale);\n  }\n  return redraw;\n}\n\nexport default function EditorFrag() {\n  const monaco = useMonaco();\n\n  const wsize = useWindowSize();\n  const [astate, setAstate] = useState();\n\n  const [setting, setSetting] = useState({\n    code: \"return Array.from(Array(SAMPLE_COUNT).keys()).map(e => 0.0)\",\n    widgets: {},\n    isComputed: false,\n    version: 0,\n  });\n\n  const currentVersion = useRef(0);\n  useEffect(() => (currentVersion.current = setting.version), [setting]);\n\n  const waveformCanvasRef = useRef();\n  const waveformState = useRef({ cursor: 0, end: 1, loudness: [0, 0, 0] });\n  useAnimationFrame((deltaTime) => {\n    let state = waveformState.current;\n    let canvas = waveformCanvasRef.current;\n    if (state && canvas) {\n      state.cursor += deltaTime;\n      let { cursor, end, loudness } = state;\n      let ctx = canvas.getContext(\"2d\");\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n      if (cursor < end) {\n        ctx.lineWidth = (0.5 * canvas.width) / loudness.length;\n\n        let opacity =\n          smoothstep(0, 0.1, cursor / end) - smoothstep(0.9, 1, cursor / end);\n        ctx.fillStyle = \"rgba(40,40,40,\" + opacity + \")\";\n        ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n        ctx.beginPath();\n        for (let i = 0; i < loudness.length; i++) {\n          let x = (canvas.width * i) / loudness.length;\n          let y = (loudness[i] * canvas.height * 0.9) / 2;\n          ctx.moveTo(x, canvas.height / 2 - y);\n          ctx.lineTo(x, canvas.height / 2 + y);\n        }\n\n        //rgba(86,156,214\n\n        ctx.strokeStyle = \"rgba(206,145,120,\" + opacity + \")\";\n        ctx.stroke();\n\n        //cursor\n        ctx.beginPath();\n        let x = (canvas.width * cursor) / end;\n        ctx.moveTo(x, 0);\n        ctx.lineTo(x, canvas.height);\n\n        //rgb(86 156 214)\n        let s = smoothstep(0, 1, 1.0 - cursor / end);\n        let r = mix(86, 61, s);\n        let g = mix(156, 201, s);\n        let b = mix(214, 176, s);\n        ctx.strokeStyle = \"rgba(\" + r + \",\" + g + \",\" + b + \",\" + opacity + \")\";\n        ctx.stroke();\n\n        //border\n        ctx.beginPath();\n\n        ctx.moveTo(0.0, 0.5);\n        ctx.lineTo(0.0, canvas.height);\n        ctx.lineTo(canvas.width, canvas.height);\n        ctx.lineTo(canvas.width, 0.5);\n        ctx.lineTo(0.0, 0.5);\n        ctx.lineWidth = 1;\n        ctx.strokeStyle = \"rgba(206,145,120,\" + opacity + \")\";\n        ctx.stroke();\n      }\n    }\n  });\n\n  const dstate = useRef({});\n\n  const ReDrawBuffer = useCallback(() => {\n    let codeResult = astate?.codeResult;\n    if (codeResult)\n      drawBuffer(canvasRef.current, codeResult.graphs, dstate.current);\n  }, [astate]);\n\n  useEffect(() => {\n    ReDrawBuffer();\n  }, [wsize]);\n\n  const [refreshIsPossible, setRefreshIsPossible] = useState(true);\n\n  const [computeTime, setComputeTime] = useState(0);\n\n  const waitingForWorker = useRef(false);\n  function setWaiting(b) {\n    waitingForWorker.current = b;\n  }\n\n  useEffect(() => {\n    async function getInitialData() {\n      let data = getQueryStringValue(\"data\");\n      if (data) {\n        let { code, widgets = {} } = await worker.compressedB64ToObj(data);\n\n        console.log(\"getInitialData\", widgets);\n        setSetting({ code, widgets, version: 10 });\n      } else {\n        loadPreset(tuto3);\n      }\n    }\n    getInitialData();\n  }, []);\n\n  function loadPreset(preset) {\n    async function getData(preset) {\n      let data = getQueryStringValue(\"data\", preset);\n      if (data) {\n        let { code, widgets = {} } = await worker.compressedB64ToObj(data);\n\n        setSetting({ code, widgets, version: 10 });\n      }\n    }\n    getData(preset);\n  }\n\n  const canvasRef = useRef();\n\n  useEffect(() => {\n    async function test() {\n      const version = currentVersion.current;\n      let res = await worker.testSetting(cloneDeep(setting));\n\n      console.log(\"computed widgets, \", res.widgets);\n\n      if (\n        res &&\n        res.widgets &&\n        (!_.isEqual(res.widgets, setting.widgets) ||\n          setting.valid !== res.valid)\n      ) {\n        console.log(\"set Widgets and valid after test\");\n        setSetting((old) => {\n          if (old.version === version)\n            return { ...old, widgets: res.widgets, valid: res.valid };\n          else return old;\n        });\n      }\n    }\n    test();\n  }, [setting]);\n\n  useEffect(() => {\n    console.log(\"Setting effect\", setting);\n  }, [setting]);\n\n  let dimOld = useCallback(() => {\n    if (astate.gainNode) {\n      try {\n        let duration = 0.05;\n        let N = (astate.audioCtx.sampleRate * duration) / 100.0;\n        var waveArray = new Float32Array(N);\n        for (var i = 0; i < N; i++) {\n          waveArray[i] = Math.pow(1.0 - i / (N - 1), 2);\n        }\n        astate.gainNode.gain.setValueCurveAtTime(\n          waveArray,\n          astate.audioCtx.currentTime,\n          0.05\n        );\n      } catch {\n        astate.source.stop();\n      }\n    }\n  }, [astate]);\n\n  const [exportedWav, setExportedWav] = useState(null);\n  const exportWav = useCallback(async () => {\n    if (astate && astate.codeResult && astate.codeResult.samples?.length > 0) {\n      setExportedWav(\"loading\");\n      let b64file = await worker.exportWav(\n        astate.audioCtx.sampleRate,\n        astate.codeResult.samples\n      );\n      setExportedWav(b64file);\n    }\n  }, [astate]);\n\n  let compute = useCallback(async () => {\n    if (astate && astate.audioCtx && setting.valid === true) {\n      dimOld();\n\n      console.log(\"compute: Start compute\");\n      let duration = setting.widgets?.DURATION?.value || 1.0;\n      let N = Math.ceil(astate.audioCtx.sampleRate * duration);\n\n      let codeResult = null;\n      try {\n        setWaiting(true);\n        let start = performance.now();\n        setExportedWav(null);\n\n        console.log(\"compute: cloning\");\n        let clone = cloneDeep(setting);\n\n        console.log(\"compute: sending: \", clone);\n        codeResult = await worker.computeSetting(\n          clone,\n          N,\n          astate.audioCtx.sampleRate\n        );\n        let end = performance.now();\n        setComputeTime(end - start);\n        console.log(\"compute: took \", end - start + \"ms\");\n\n        let test = codeResult.samples[0];\n      } catch (e) {\n        console.error(\"compute: Crash try, \", e);\n        return;\n      } finally {\n        setTimeout(() => {\n          setWaiting(false);\n          setRefreshIsPossible(true);\n        }, 100);\n      }\n\n      async function saveSetting() {\n        let settingClone = cloneDeep(setting);\n        Object.keys(settingClone.widgets).forEach((k) => {\n          if (settingClone.widgets[k].type === \"sound\")\n            settingClone.widgets[k].value = [];\n        });\n        let str = await worker.objToCompressedB64(settingClone);\n        setQueryStringValue(\"data\", str);\n      }\n      saveSetting();\n\n      var myArrayBuffer = astate.audioCtx.createBuffer(\n        1,\n        N,\n        astate.audioCtx.sampleRate\n      );\n\n      for (\n        var channel = 0;\n        channel < myArrayBuffer.numberOfChannels;\n        channel++\n      ) {\n        var nowBuffering = myArrayBuffer.getChannelData(channel);\n\n        for (var i = 0; i < myArrayBuffer.length; i++) {\n          nowBuffering[i] = codeResult.samples[i];\n        }\n      }\n\n      let source = astate.audioCtx.createBufferSource();\n      source.buffer = myArrayBuffer;\n\n      var gainNode = astate.audioCtx.createGain();\n      gainNode.gain.value = 1.0;\n      source.connect(gainNode);\n      gainNode.connect(astate.audioCtx.destination);\n\n      //   source.connect(astate.audioCtx.destination);\n      source.start();\n\n      codeResult.graphs = codeResult.graphs || [codeResult.samples] || [];\n      // graphs.push(codeResult.loudness);\n      waveformState.current = {\n        cursor: 0,\n        end: duration * 1000,\n        loudness: codeResult.loudness,\n      };\n\n      drawBuffer(canvasRef.current, codeResult.graphs, dstate.current);\n\n      setAstate((old) => {\n        return {\n          ...old,\n          source,\n          gainNode,\n\n          codeResult,\n        };\n      });\n    }\n  }, [astate, setting, dimOld]);\n\n  const play = useCallback(() => {\n    let codeResult = astate.codeResult;\n    if (codeResult) {\n      dimOld();\n      let duration = setting.widgets?.DURATION?.value || 1.0;\n      let N = Math.ceil(astate.audioCtx.sampleRate * duration);\n\n      var myArrayBuffer = astate.audioCtx.createBuffer(\n        1,\n        N,\n        astate.audioCtx.sampleRate\n      );\n\n      for (\n        var channel = 0;\n        channel < myArrayBuffer.numberOfChannels;\n        channel++\n      ) {\n        var nowBuffering = myArrayBuffer.getChannelData(channel);\n\n        for (var i = 0; i < myArrayBuffer.length; i++) {\n          nowBuffering[i] = codeResult.samples[i];\n        }\n      }\n\n      let source = astate.audioCtx.createBufferSource();\n      source.buffer = myArrayBuffer;\n\n      var gainNode = astate.audioCtx.createGain();\n      gainNode.gain.value = 1.0;\n      source.connect(gainNode);\n      gainNode.connect(astate.audioCtx.destination);\n\n      //   source.connect(astate.audioCtx.destination);\n\n      source.start();\n      waveformState.current = {\n        cursor: 0,\n        end: duration * 1000,\n        loudness: codeResult.loudness,\n      };\n      setAstate((old) => {\n        return { ...old, source, gainNode };\n      });\n    }\n  }, [astate, dimOld]);\n\n  useEffect(() => {\n    if (refreshIsPossible) {\n      if (\n        setting.valid === true &&\n        !waitingForWorker.current &&\n        !setting.isComputed\n      ) {\n        setSetting((old) => {\n          return { ...old, isComputed: true };\n        });\n        compute();\n      } else if (setting.valid === true && waitingForWorker.current) {\n        setRefreshIsPossible(false);\n      }\n    }\n  }, [compute, astate, setting, refreshIsPossible]);\n\n  useEffect(() => {\n    var audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n    setAstate({ audioCtx });\n  }, []);\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        background: \"rgb(62, 62, 62)\",\n        height: window.innerHeight,\n        overflow: \"hidden\",\n      }}\n    >\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          background: \"rgb(62, 62, 62)\",\n          flex: \"1 1 auto\",\n          overflow: \"hidden\",\n        }}\n      >\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            flex: \"1 60 auto\",\n            margin: \"5px\",\n            marginRight: \"0px\",\n            padding: \"10px\",\n            background: \"rgb(30 30 30)\",\n            borderRadius: \"3px\",\n\n            overflow: \"hidden\",\n          }}\n        >\n          <div\n            style={{ display: \"flex\", flexDirection: \"row\", marginTop: \"10px\" }}\n          >\n            <button\n              style={{\n                padding: \"10px\",\n                marginRight: \"5px\",\n                fontSize: \"0.8em\",\n                cursor: \"pointer\",\n                backgroundColor: \"#3dc9b0\",\n                border: \"none\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => {\n                play();\n              }}\n            >\n              Play\n            </button>\n            <button\n              style={{\n                padding: \"10px\",\n                marginRight: \"5px\",\n                cursor: \"pointer\",\n                fontSize: \"0.8em\",\n                backgroundColor: \"#3dc9b0\",\n                border: \"none\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => {\n                compute();\n              }}\n            >\n              Compile\n            </button>\n            {exportedWav && exportedWav !== \"loading\" && (\n              <a\n                href={exportedWav}\n                download=\"exported_sound.wav\"\n                target=\"_blank\"\n                style={{\n                  padding: \"10px\",\n                  fontSize: \"0.8em\",\n                  cursor: \"pointer\",\n                  backgroundColor: \"#569cd6\",\n                  border: \"none\",\n                  borderRadius: \"3px\",\n                  textDecoration: \"none\",\n                  color: \"black\",\n                }}\n              >\n                Download exported\n              </a>\n            )}\n            {exportedWav === \"loading\" && (\n              <div\n                style={{\n                  padding: \"10px\",\n                  fontSize: \"0.8em\",\n\n                  backgroundColor: \"#569cd6\",\n                  border: \"none\",\n                  borderRadius: \"3px\",\n                }}\n              >\n                Loading\n              </div>\n            )}\n            {!exportedWav && (\n              <button\n                style={{\n                  padding: \"10px\",\n                  fontSize: \"0.8em\",\n                  cursor: \"pointer\",\n                  backgroundColor: \"#3dc9b0\",\n                  border: \"none\",\n                  borderRadius: \"3px\",\n                }}\n                onClick={() => {\n                  exportWav();\n                }}\n              >\n                Export\n              </button>\n            )}\n          </div>\n\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"row\",\n              marginTop: \"10px\",\n              alignItems: \"center\",\n            }}\n          >\n            <div\n              style={{ color: \"grey\", fontSize: \"0.8em\", marginRight: \"3px\" }}\n            >\n              Tutorial/demo\n            </div>\n            {[\n              [\"1\", tuto1],\n              [\"2\", tuto2],\n              [\"3\", tuto3],\n              [\"4\", tuto4],\n              [\"5\", tuto5],\n              [\"6\", tuto6],\n              [\"7\", tuto7],\n            ].map(([name, tuto]) => (\n              <button\n                style={{\n                  padding: \"8px\",\n                  cursor: \"pointer\",\n                  marginRight: \"3px\",\n                  backgroundColor: \"#099\",\n                  border: \"none\",\n                  borderRadius: \"3px\",\n                }}\n                onClick={() => loadPreset(tuto)}\n              >\n                {name}\n              </button>\n            ))}\n          </div>\n          <div\n            style={{\n              fontSize: \"0.8em\",\n              marginTop: \"10px\",\n              color: \"white\",\n              textAlign: \"left\",\n            }}\n          >\n            <div> Write your sound function on the right !</div>\n            <div>\n              The samples you return will be played on your speaker, and the\n              graphs your return plotted.\n            </div>\n          </div>\n\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"row\",\n              flex: \"1 1 auto\",\n              marginTop: \"20px\",\n              flexWrap: \"wrap\",\n              overflowY: \"auto\",\n            }}\n          >\n            {Object.keys(setting.widgets)\n              .map((p) => {\n                return { name: p, ...setting.widgets[p] };\n              })\n              .map((p) => (\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexDirection: \"row\",\n                    userSelect: \"none\",\n                  }}\n                >\n                  {p.min != null && (\n                    <RSlider\n                      name={p.name}\n                      min={p.min}\n                      max={p.max}\n                      step={p.step}\n                      value={p.value}\n                      unit={p.unit}\n                      onChange={(v) =>\n                        setSetting((old) => {\n                          let obj = cloneDeep(old.widgets);\n                          obj[p.name].value = v;\n                          return {\n                            ...old,\n                            widgets: obj,\n                            isComputed: false,\n                            version: old.version + 1,\n                          };\n                        })\n                      }\n                    ></RSlider>\n                  )}\n                  {p.width != null && (\n                    <Grid\n                      name={p.name}\n                      value={p.value}\n                      onChange={(newGrid) => {\n                        setSetting((old) => {\n                          let obj = cloneDeep(old.widgets);\n                          try {\n                            obj[p.name].value = newGrid;\n                          } catch {}\n                          return {\n                            ...old,\n                            widgets: obj,\n                            isComputed: false,\n                            version: old.version + 1,\n                          };\n                        });\n                      }}\n                    ></Grid>\n                  )}\n                  {p.type === \"curve\" && (\n                    <Curve\n                      name={p.name}\n                      value={p.value}\n                      onChange={(newGrid) => {\n                        setSetting((old) => {\n                          let obj = cloneDeep(old.widgets);\n                          try {\n                            obj[p.name].value = newGrid;\n                          } catch {}\n                          return {\n                            ...old,\n                            widgets: obj,\n                            isComputed: false,\n                            version: old.version + 1,\n                          };\n                        });\n                      }}\n                    ></Curve>\n                  )}\n                  {p.type === \"sound\" && (\n                    <InSound\n                      name={p.name}\n                      value={p.value}\n                      onChange={(newGrid) => {\n                        setSetting((old) => {\n                          let obj = cloneDeep(old.widgets);\n                          try {\n                            obj[p.name].value = newGrid;\n                          } catch {}\n                          return {\n                            ...old,\n                            widgets: obj,\n                            isComputed: false,\n                            version: old.version + 1,\n                          };\n                        });\n                      }}\n                    ></InSound>\n                  )}\n                </div>\n              ))}\n          </div>\n        </div>\n        <div\n          style={{\n            flex: \"1 1 auto\",\n            margin: \"5px\",\n            padding: \"0px\",\n            background: \"rgb(30 30 30)\",\n            minWidth: \"677px\",\n            borderRadius: \"3px\",\n            overflow: \"hidden\",\n            position: \"relative\",\n          }}\n        >\n          <Editor\n            height=\"60vh\"\n            defaultLanguage=\"javascript\"\n            defaultValue={setting.code}\n            value={setting.code}\n            onChange={(v, e) =>\n              setSetting((old) => {\n                return {\n                  ...old,\n                  code: v,\n                  valid: undefined,\n                  isComputed: false,\n                  version: old.version + 1,\n                };\n              })\n            }\n            theme=\"vs-dark\"\n            options={{\n              fontSize: \"12\",\n            }}\n          />\n          <div\n            style={{\n              color: \"grey\",\n              fontSize: \"0.7em\",\n              textAlign: \"right\",\n              position: \"absolute\",\n              bottom: \"0px\",\n              right: \"0px\",\n            }}\n          >\n            {Math.floor(computeTime) + \" ms\"}\n          </div>\n        </div>\n      </div>\n\n      <div\n        style={{\n          margin: \"0px 5px 5px 5px\",\n          padding: \"0px\",\n          flex: \"none\",\n\n          height: Math.floor(wsize.height * 0.35) + \"px\",\n          position: \"relative\",\n        }}\n      >\n        <div style={{ borderRadius: \"3px\", overflow: \"hidden\" }}>\n          <canvas\n            onMouseMove={(e) => {\n              var rect = e.target.getBoundingClientRect();\n              var x = e.clientX - rect.left; //x position within the element.\n              var y = e.clientY - rect.top; //y position within the element.\n              if (astate?.codeResult) {\n                let redraw = handleMouse(\n                  dstate.current,\n                  astate.codeResult.graphs,\n                  wsize.width - 10,\n                  Math.floor(wsize.height * 0.35),\n                  x,\n                  y\n                );\n              }\n            }}\n            onContextMenu={(e) => e.preventDefault()}\n            onMouseDown={(e) => {\n              if (astate?.codeResult) {\n                let redraw = handleMouse(\n                  dstate.current,\n                  astate.codeResult.graphs,\n                  wsize.width - 10,\n                  Math.floor(wsize.height * 0.35),\n                  null,\n                  null,\n                  e.button === 0 ? 1 : -1\n                );\n                if (redraw) ReDrawBuffer();\n              }\n            }}\n            ref={canvasRef}\n            width={wsize.width - 10}\n            height={Math.floor(wsize.height * 0.35)}\n            // style={{ width: \"100%\", minHeight: \"50px\" }}\n          ></canvas>\n        </div>\n\n        <canvas\n          style={{\n            position: \"absolute\",\n            left: \"50%\",\n            top: \"0px\",\n            transform: \"translate(-50%,-50%)\",\n            borderRadius: \"0px\",\n            overflow: \"hidden\",\n          }}\n          width={wsize.width / 4}\n          height={Math.floor(wsize.height * 0.05)}\n          ref={waveformCanvasRef}\n        ></canvas>\n      </div>\n    </div>\n  );\n}\n","import logo from \"./logo.svg\";\nimport \"./App.css\";\nimport EditorFrag from \"./frag/Editor\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <EditorFrag></EditorFrag>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}