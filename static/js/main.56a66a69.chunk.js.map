{"version":3,"sources":["frag/Editor.js","frag/RSlider.js","frag/Compute.js","webpack:///./src/frag/Compute.js?4145","logo.svg","App.js","reportWebVitals.js","index.js"],"names":["fft","require","pako","qs","cloneDeep","worker","MyWorker","tuto1","tuto2","tuto3","tuto4","drawBuffer","canvas","buffers","ctx","getContext","bufferIndex","buffer","h","height","w","width","length","undefined","Array","isArray","constructor","Float32Array","resetTransform","translate","min","reduce","prev","curr","max","vToH","v","console","log","clearRect","fillStyle","fillRect","strokeStyle","lineWidth","beginPath","moveTo","lineTo","mol","Math","ceil","pol","floor","stroke","i","hashCode","s","split","a","b","charCodeAt","setQueryStringWithoutPageReload","qsValue","newurl","window","location","protocol","host","pathname","history","pushState","path","setQueryStringValue","key","value","queryString","search","values","parse","newQsValue","stringify","getQueryStringValue","ID","random","toString","substr","compileJsSoundCode","code","params","hash","map","e","join","paramsArgs","name","code2","slice","f","eval","func","valid","error","EditorFrag","monaco","useMonaco","useEffect","computeBuffer","doo","useState","astate","setAstate","setting","setSetting","loadPreset","preset","data","compressedB64ToObj","getData","getInitialData","canvasRef","useRef","res","matchAll","usage","newParams","changeParams","findIndex","push","step","unit","forEach","parseFloat","index","sqrt","current","filter","e2","old","setParams","codeCompiled","useMemo","compute","useCallback","audioCtx","putInQuery","obj","objToCompressedB64","str","gainNode","N","sampleRate","waveArray","pow","gain","setValueCurveAtTime","currentTime","source","stop","duration","find","codeResult","paramsVal","channel","samples","myArrayBuffer","createBuffer","numberOfChannels","nowBuffering","getChannelData","createBufferSource","createGain","connect","destination","start","graphs","AudioContext","webkitAudioContext","style","display","flexDirection","background","innerHeight","overflow","flex","margin","padding","borderRadius","backgroundColor","border","onClick","marginTop","marginLeft","fontSize","color","flexWrap","p","onChange","arr","elem","minWidth","defaultLanguage","defaultValue","c","theme","options","ref","innerWidth","minHeight","polarToCartesian","centerX","centerY","radius","angle","x","cos","y","sin","describeArc","startAngle","endAngle","end","largeArcFlag","PI","WIDTH","SvgComponent","state","a2","arcpaths","cx","cy","viewBox","boxSizing","r","strokeWidth","fill","d","strokeLinecap","cursor","format","round","RSlider","maxTurn","mousemove","event","rectSize","getBoundingClientRect","center","relativeX","clientX","left","relativeY","clientY","top","angleBetweenTwoVectors","atan2","isNaN","newValue","clicked","setClicked","addEventListener","removeEventListener","position","onMouseDown","transform","fontWeight","inst","wrap","Worker","module","exports","this","App","className","Editor","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.56a66a69.chunk.js","sourcesContent":["import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport React from \"react\";\n\nimport { createEvent } from \"@testing-library/dom\";\nimport RSlider from \"./RSlider\";\nimport ReactFlow, { Handle } from \"react-flow-renderer\";\nimport * as base64 from \"byte-base64\";\nimport Editor, { useMonaco } from \"@monaco-editor/react\";\n// eslint-disable-next-line\nimport MyWorker from \"comlink-loader!./Compute\";\nconst fft = require(\"jsfft\");\nconst pako = require(\"pako\");\nconst qs = require(\"query-string\");\nvar cloneDeep = require(\"lodash.clonedeep\");\n\n// instantiate a new Worker with our code in it:\nconst worker = new MyWorker();\n\nconst tuto1 =\n  \"?data=eJxtkm9v2jAQxr%2FKya8KzRJnK5qUri%2FQykaltWX982IiaDLJAV4dG8U2FBDffWdCqKrtVc7ne36%2B5y47VpgSWcaSJLmWc%2BmEAmu8LkFa%2BOOtAwEWHZgZWFEtFdoY%2BscQalzWaFE7e9SEo%2FU1ggi6uVyhBicrjHNN%2FCHSzcZ4KISGEmdS4z90cAvSrqVSMEVYKrHBEqaieAFngjbXBxR8V2YqlAVByAyunx%2F6Tzf3dxHQdwBnFxcp54ttHHcieOzfjn4Mfn%2B9f757atW%2F3jdRkE9TgVWyxBqmG%2FBW6jkUpqoO5pR8QWqMJmKoOgsMbxG%2BPQx%2BQo%2BHzug5HoQpDLeX4RVFrlpLVzCe5Hpmajh7S1OWX7bxl3ddtunz8w7scg2QJGGIIDUNqzC6tCEZUIf01bE8Cd6b8scGW4X90Rin6NZIq%2FiQgqAtpaHo2Ny4%2BU6IcivcIibjZwdf3QbebdKjG%2Bh%2BjHmnwY%2F8yUWhjKWZ0QgOc1BmHU4LhJVRvsL%2FvNQl4%2FHnXO9zXaPztW4LWMSWohaVZdl4x7Sowm%2FZbpYuK6lZxuMeReKVZSmPmHW4DLk0YiuhPAko8lo6Ulq2j06YYKlF9PiJwE%2BMN91wy060T5zvJ%2Fu%2FqeoC8g%3D%3D\";\n\nconst tuto2 =\n  \"?data=eJydk1tv2jAUgP%2FKkZ9yI3EYaFJaNkU0E2gt7bg8TARVhpoRLXEQcVpWxH%2Bf7VzItGyd9gCxzznflxPn5IQ26RNFHnIcZ8f5PvMchzL7Jfoe7elTROz08M2ROydgzzRO9%2FRRS%2FIs2ughC5nj5BmFT9PgC%2FQx8BRcjDGsf4ALo9erKu%2FP5%2F7wM2Abu7IG264sUdusLroJhv7XN2pmi9ncH0%2FqqraaaXAb%2BLOgYer%2BUiXr7gjfwYjGe3qAbc42PEpZFrKYctjEJNnDALSjBcSCtQ6DDyDr7YQcNREp1hHT1hYcdb2gtjHhGacKlJRMSVDZNO0IHSA6OKCt1coCbIFbspSIrgXHFcHhGuw%2BfIQuGGIjfx50XDBB6wlWRXX5V8BZkqZ813ZrqdWqvuqMemsKFI3FNBPUchWybXoA7RIWUXxVra9h5t893AaPw%2FvFZF6FTVOHU8gAJMWjRDJFxpn680Bmylssi%2BtKFKizy8TZqYkxCs4owg9jMLo2Vg0COPW4QZvKGDSeXMNWMWGWEup%2FAFwbd8QwGA2wxIqLqSbw747f2AIyy8E0y%2BGzoC1bq1vkwo3t9yE7h%2BxAeX5gVQGy0J4cSJIhb3lCjCTyW71ZiDMe309EUkwi8rDdFytyRJ6LLSTbkzHXQs8kzgUgVjmLuCAzdLZqjXwLlaKPawOuHRdu9IpqW6%2BHG5LiSS%2BdYLcUqQaqXnCzhdok4u8aKnVa%2F23qNUzlibe4%2FsHUFJUvtLWp7tsq1z2vzj8BM4CUgw%3D%3D\";\n\nconst tuto3 =\n  \"?data=eJx9Vf1v2kgQ%2FVdGlk5aF2PWBkohTStEiRq1SXr5uF8SVC2wYOuM7drrhDTif7%2BZXX%2BFy12kYO%2Fsmzdv386uX6xVspbWxOr1ilzCX1ff7y7mAMBdzkEl4LkcYPmMY%2B%2FkITag6e030H8I8giEz6EBcQzkNfDL%2FGZWAj0goO9CyfYKd3Y9%2F1PjhlhMV%2F2A1RHncQh%2B17Cv0%2BuLq8vzGYoysFFJ57k15vxyVmvTmMGrBRDsQqgAvsoolRlsinilwiTOH%2BJIKlhFYpfCKbC9A8KBpQ2nn4Dw7k7sGUbMexizpQN72zZZm0ioXEmdSFk0RYmajbE9dEHY0AO21G8OcAe8MlcKFI15Smco%2BAjuED6DD%2B9wQP8T6HrQATbAXB216cck57skUcFbpYmWVbrqmbLmLtw3%2BJ3GCyRltNddCnRgieOdNvUmKeI13DzHKpB5mB87lhaZ1r%2FJ5C8HVGNYjiZRsFwISdfxH%2BelCpWFIt5Gb2eLZc5Yk9%2FF7fOHNvxB%2FUgG%2BFrq8aB05Vch%2Fi2qKtcEP%2Bke%2BaxbnFyu88XTcXKjpKVA1zQpQv1NKesK32wMw73WYQNcy1VjfWu9cp%2Bybr%2FyiJoN89RR45QcT0GoZJyEpnEajkzE62THjhypdjDNkpXMcVe2x1uYyUeZLYlrWWw2MnMgEltNa8buJsnmYhUwJh0IHZKEcyH6hzj0T9yHC%2Bic0hOLYmyBCrg7QFN5KTkPd2kkz85umyqa5OUhBqyviiyGWD7BZqPcWULY%2FTTLxHOJdSMZb1VgozF4nh5FVBglcUMCoMNuJkWERUweCjuhyYPtYm2GYg7VFlONHIGmzM304sf3%2Bc%2FZ1d3lLaJwwcAqHIL4iXn7CG2gCXY6tlGgexrBGtmD6%2Bnt%2FKSKUyVsNj3W5I8iQwc1c4i01c2Go5rPZOrGOzU3ZNkdafLE8JpDB%2BwGlwcipX6g81i3bjNN6w1VsSZITcLdYUOS6y2sYe8Mo3aPfkrH7um5oF3MEYJtz%2FBj4JhLCXvbjOjaL2Pme2KM7%2FVMp7GSy6FDzRFEVlVX6Ub9JA%2BrfqmwtPXbWEtjtptH4UrSCWlvB3ruI0vZTS8t0Q69bzORBvkE7qsglVqgMMuxUpGJXW5N7l%2BsWOzoa%2FjlDkWdX13iJN721oSssvBYWhOPOxYdbIp5jqW7DqOOVaA8zMytg1PTmOXXJBXFK4Yyz6q5sFaLAh1tRHCvpKAvbsPCebt%2Bi4j7fv89fz8aj0aD8Xj0YTxqMdM2NdQVs9%2Bi%2FQ%2FWwWDke%2F3heIic4%2BFo3OKkPq04h%2FV68WtesZJ9JWfwuyHtc95iqY5DxVRpG9Usb9jWbxHg8Tg2ffD%2FpvuHxeEf4%2FOUOQ%3D%3D\";\n\nconst tuto4 =\n  \"?data=eJx9VWlP20AQ%2FSsjS5XWxDFrE2MSLkU0FVG5ytEvgKpNYojV%2BMBeQwDlv3dm1xcpbSTw7ux7b2bfjtfvxjSZBcbA2Nws8gB%2Bnp%2FcnI4AgNucg0zAsTnA5BXnzu5drEHD6%2B%2BgfghyCIRPT4M4BvIa%2BHV0dVQCHSCga0Op9gH37XL0Q%2BE8TKay7mB2xDkc5m817Hh4eXp%2BNj7CojTML%2BUcu8aMz47q2hSm92EDBDsVcg7HwSINMngo4qkMkzi%2FixeBhOlCRCnsA1taICyYmLB%2FAIS3I7FkGNHjMGYTC5amqVkPCyFzGSgisWiJiEqNsSV0QZiwCWyiRhZwC5ySGwgsGnlSMSTsge3BIbiwgRP6G0DXgQ6wHnJV1KR%2FmpxHSSLnn6UmWVbVVa%2BUOaNw2eAjhRcoyuisuxTowATnkTL1KiniGVy9xnIe5GG%2B7lhaZKr%2Bhyx4skA2huVoEgXLjVDpKn4xLquQWSjix8XnbDHJGWv4XTw%2B1zPhC%2FUjGeCqUtcnpStPhfi7qCpdEzxQPXKoWpxcrvniZZ3cVNKqQOXUFCF%2FE2VW4ZuDYXjWKqyBs2DaWN%2Fab7BMWXer8oiaDXlyrXFKjUy8xIlUG6RnI5ImL8y1LR1GRt8msuOa1Pd6Z1G6CHJkDrNMvLKr4enFyejX0fnN2TWCHpIMWIVDEN%2FVoz1oA3Ww0zHh%2FS4GUEeJYIXchMvh9Wi3ilMm9LieZ2qupre4P1e9CT39Prj3NuYfiemcsVjtSckDqKqeRQahLinEeqqbAGd1IfRTbyMd1X7lEmlt6Atmo3EJbwkLQrNNy%2BciJU%2BpoeuzbwPIu1AWMwLVQtz22kIZdPZbwA2tqldX%2BpETJMMl7BmGN6ml32hsDD2jO7NJjS1AljmenioDabhS6%2BV53tLznvohRyV9heM6JswCWWSx9qcEWzR%2BzEQ6zwdwWwbvEW1YRioyEeXG4PbdiEVEX4WvN3ig4%2FMzXMRbzxjQfg1sT2PgcMugBqeYYxnPYlEgwaH1Ig4lcnNjZdVCuqpaphL5oFHyjFoNs7Uk0J6mDO6UEvTtaVQ4d1r5W0Lcdbe2%2Bbbf9%2F1ev%2B%2Fv9P2WMnneSFfKbkv2H6q9nu86W17fQ82%2B5%2FdbmtRylaZX7xe%2Fa5UqGVhqzt8a0S3OWypVo1dKVW1%2BrfKJbW3TsNPXTe%2F933R3db%2F6A6uoOxk%3D\";\n\n/**\n * @param {HTMLCanvasElement} canvas\n * @param {Array} buffer\n */\nfunction drawBuffer(canvas, buffers) {\n  let ctx = canvas.getContext(\"2d\");\n\n  for (let bufferIndex = 0; bufferIndex < buffers.length; bufferIndex++) {\n    let buffer = buffers[bufferIndex];\n    let h = canvas.height;\n    let w = canvas.width / buffers.length;\n\n    if (\n      buffer === undefined ||\n      (!Array.isArray(buffer) && buffer.constructor !== Float32Array) ||\n      buffer.length < 2\n    )\n      continue;\n\n    ctx.resetTransform();\n    ctx.translate(bufferIndex * w, 0.0);\n\n    let min = buffer.reduce((prev, curr) => (curr < prev ? curr : prev));\n    let max = buffer.reduce((prev, curr) => (curr > prev ? curr : prev));\n\n    console.log(\"min max \", min, max);\n\n    ctx.width = w;\n    ctx.height = h;\n\n    console.log(w);\n\n    ctx.clearRect(0, 0, w, h);\n\n    ctx.fillStyle = \"rgb(30,70,70)\";\n    ctx.fillRect(0, 0, w, h);\n\n    ctx.fillStyle = \"rgb(30,30,30)\";\n    ctx.fillRect(1, 1, w - 1, h - 1);\n\n    function vToH(v) {\n      return h - ((v - min) / (max - min)) * h;\n    }\n    ctx.strokeStyle = \"#977\";\n    ctx.lineWidth = \"1\";\n    ctx.beginPath();\n    ctx.moveTo(0, vToH(0));\n    ctx.lineTo(w, vToH(0));\n\n    let mol = Math.ceil(vToH(-1)) + 0.5;\n    ctx.moveTo(0, mol);\n    ctx.lineTo(w, mol);\n\n    let pol = Math.floor(vToH(1)) - 0.5;\n    ctx.moveTo(0, pol);\n    ctx.lineTo(w, pol);\n    ctx.stroke();\n\n    ctx.beginPath();\n    ctx.moveTo(0, vToH(buffer[0]));\n    for (var i = 0; i < buffer.length; i++) {\n      let v = buffer[i];\n      ctx.lineTo((i / (buffer.length - 1)) * w, vToH(v));\n    }\n\n    ctx.strokeStyle =\n      bufferIndex % 2 === 0 ? \"rgb(96, 197, 177)\" : \"rgb(100, 153, 211)\";\n    ctx.lineWidth = \"1\";\n    ctx.stroke();\n  }\n}\n\nfunction hashCode(s) {\n  return s.split(\"\").reduce(function (a, b) {\n    a = (a << 5) - a + b.charCodeAt(0);\n    return a & a;\n  }, 0);\n}\n\nconst setQueryStringWithoutPageReload = (qsValue) => {\n  const newurl =\n    window.location.protocol +\n    \"//\" +\n    window.location.host +\n    window.location.pathname +\n    qsValue;\n\n  window.history.pushState({ path: newurl }, \"\", newurl);\n};\n\nconst setQueryStringValue = (\n  key,\n  value,\n  queryString = window.location.search\n) => {\n  const values = qs.parse(queryString);\n  const newQsValue = qs.stringify({ ...values, [key]: value });\n  setQueryStringWithoutPageReload(`?${newQsValue}`);\n};\n\nexport const getQueryStringValue = (\n  key,\n  queryString = window.location.search\n) => {\n  const values = qs.parse(queryString);\n  return values[key];\n};\n\nvar ID = function () {\n  // Math.random should be unique because of its seeding algorithm.\n  // Convert it to base 36 (numbers + letters), and grab the first 9 characters\n  // after the decimal.\n  return \"_\" + Math.random().toString(36).substr(2, 9);\n};\n\nfunction compileJsSoundCode(code, params) {\n  let hash = hashCode(code + params.map((e) => e.value + \"\").join(\";\"));\n  try {\n    let paramsArgs = params.map((e) => e.name + \",\").join(\"\");\n    let code2 =\n      \"((SAMPLE_COUNT, RATE,CHANNEL, {\" +\n      paramsArgs.slice(0, -1) +\n      \"}) => {\" +\n      code +\n      \"})\";\n\n    let f = eval(code2);\n    let a = f([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 44100, 1, {});\n    return { func: f, valid: true, hash };\n  } catch (e) {\n    console.error(\"CANT USE CODE \", e);\n    return { func: () => 0.0, valid: false, hash };\n  }\n}\n\nexport default function EditorFrag() {\n  const monaco = useMonaco();\n\n  useEffect(() => {\n    if (monaco) {\n      console.log(\"here is the monaco isntance:\", monaco);\n      // monaco.editor.trigger(\"keyboard\", \"editor.action.fontZoomOut\", {});\n    }\n  }, [monaco]);\n\n  useEffect(() => {\n    async function doo() {\n      let buffer = await worker.computeBuffer(\"() => [1, 2, 3, 4, 5, 6]\", {});\n      console.log(\"BUFFER \", buffer);\n    }\n    doo();\n  }, []);\n\n  const [astate, setAstate] = useState();\n\n  const [setting, setSetting] = useState({\n    code: \"return []\",\n    params: [],\n  });\n\n  const code = setting.code;\n  const params = setting.params;\n\n  function setCode(c) {\n    setSetting((old) => {\n      return { ...old, code: c };\n    });\n  }\n  function setParams(newParams) {\n    setSetting((old) => {\n      return { ...old, params: newParams };\n    });\n  }\n\n  // const [code, setCode] = useState(\"return []\");\n  // const [params, setParams] = useState([]);\n\n  useEffect(() => {\n    async function getInitialData() {\n      let data = getQueryStringValue(\"data\");\n      if (data) {\n        let { code, params } = await worker.compressedB64ToObj(data);\n        setSetting({ code, params });\n      } else {\n        loadPreset(tuto3);\n      }\n    }\n    getInitialData();\n  }, []);\n\n  function loadPreset(preset) {\n    async function getData(preset) {\n      let data = getQueryStringValue(\"data\", preset);\n      if (data) {\n        let { code, params } = await worker.compressedB64ToObj(data);\n\n        setSetting({ code, params });\n      }\n    }\n    getData(preset);\n  }\n\n  const canvasRef = useRef();\n\n  useEffect(() => {\n    let res = [\n      ...setting.code.matchAll(\n        \"//use ([a-zA-Z0-9_]+) +([0-9.]+) +to +([0-9.]+) +by +([0-9.]*)+ *([a-zA-Z/0-9]*) *; *\\n\"\n      ),\n    ];\n\n    let usage = {};\n\n    let newParams = setting.params.slice();\n    let changeParams = false;\n    if (newParams.findIndex((e) => e.name === \"DURATION\") === -1) {\n      changeParams = true;\n      newParams.push({\n        name: \"DURATION\",\n        min: 0.5,\n        max: 10.0,\n        step: 0.1,\n        value: 1.0,\n        unit: \"s\",\n      });\n    }\n\n    setting.params.forEach((e) => {\n      usage[e.name] = 0;\n    });\n\n    usage[\"DURATION\"] = 1;\n\n    for (var i = 0; i < res?.length || 0; i++) {\n      let name = res[i][1];\n      let min = 0;\n      let max = 1;\n      let step = 0.01;\n\n      min = parseFloat(res[i][2]);\n      max = parseFloat(res[i][3]);\n      step = parseFloat(res[i][4]);\n      let unit = res[i][5] || \"\";\n\n      let index = setting.params.findIndex((e) => e.name === name);\n      if (index === -1) {\n        changeParams = true;\n        newParams.push({\n          name,\n          min,\n          max,\n          step,\n          unit,\n          value: min > 0 ? Math.sqrt(max * min) : max / 2,\n        });\n      } else {\n        let current = params[index];\n        if (\n          current.min !== min ||\n          current.max !== max ||\n          current.step !== step ||\n          current.unit != unit\n        ) {\n          changeParams = true;\n          current.min = min;\n          current.max = max;\n          current.step = step;\n          current.unit = unit;\n          current.value =\n            current.value >= min && current.value <= max\n              ? current.value\n              : min > 0\n              ? Math.sqrt(max * min)\n              : max / 2;\n        }\n      }\n\n      usage[name] = (usage[name] || 0) + 1;\n    }\n\n    setting.params.forEach((e) => {\n      if (usage[e.name] === 0) {\n        changeParams = true;\n        newParams = newParams.filter((e2) => e2.name !== e.name);\n      }\n    });\n\n    if (changeParams === true) setParams(newParams);\n  }, [setting]);\n\n  const codeCompiled = useMemo(() => {\n    return compileJsSoundCode(setting.code, setting.params);\n  }, [setting]);\n\n  let compute = useCallback(() => {\n    if (astate && astate.audioCtx && codeCompiled.valid === true) {\n      if (astate.gainNode) {\n        try {\n          let duration = 0.05;\n          let N = (astate.audioCtx.sampleRate * duration) / 10.0;\n          var waveArray = new Float32Array(N);\n          for (var i = 0; i < N; i++) {\n            waveArray[i] = Math.pow(1.0 - i / (N - 1), 2);\n          }\n          astate.gainNode.gain.setValueCurveAtTime(\n            waveArray,\n            astate.audioCtx.currentTime,\n            0.05\n          );\n        } catch {\n          astate.source.stop();\n        }\n      }\n\n      let duration = params.find((e) => e.name === \"DURATION\")?.value || 1.0;\n      let N = Math.ceil(astate.audioCtx.sampleRate * duration);\n\n      let codeResult = null;\n      try {\n        let paramsVal = {};\n        params.forEach((e) => (paramsVal[e.name] = e.value));\n        codeResult = codeCompiled.func(\n          N,\n          astate.audioCtx.sampleRate,\n          channel,\n          paramsVal\n        );\n\n        if (Array.isArray(codeResult)) {\n          codeResult = { samples: codeResult };\n        }\n      } catch {\n        return;\n      }\n\n      var myArrayBuffer = astate.audioCtx.createBuffer(\n        1,\n        N,\n        astate.audioCtx.sampleRate\n      );\n\n      for (\n        var channel = 0;\n        channel < myArrayBuffer.numberOfChannels;\n        channel++\n      ) {\n        var nowBuffering = myArrayBuffer.getChannelData(channel);\n\n        for (var i = 0; i < myArrayBuffer.length; i++) {\n          nowBuffering[i] = codeResult.samples[i];\n        }\n      }\n\n      async function putInQuery(obj) {\n        let str = await worker.objToCompressedB64(obj);\n        setQueryStringValue(\"data\", str);\n      }\n      putInQuery(\n        cloneDeep({\n          code,\n          params,\n        })\n      );\n\n      let source = astate.audioCtx.createBufferSource();\n      source.buffer = myArrayBuffer;\n\n      var gainNode = astate.audioCtx.createGain();\n      gainNode.gain.value = 1.0;\n      source.connect(gainNode);\n      gainNode.connect(astate.audioCtx.destination);\n\n      //   source.connect(astate.audioCtx.destination);\n      source.start();\n\n      drawBuffer(\n        canvasRef.current,\n        codeResult.graphs || [codeResult.samples] || []\n      );\n\n      setAstate((old) => {\n        return { ...old, source, gainNode, hash: codeCompiled?.hash };\n      });\n    }\n  }, [astate, codeCompiled]);\n\n  useEffect(() => {\n    if (codeCompiled.valid === true && astate?.hash !== codeCompiled?.hash) {\n      compute();\n    }\n  }, [codeCompiled, compute, astate, params]);\n\n  useEffect(() => {\n    var audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n    setAstate({ audioCtx });\n  }, []);\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        background: \"rgb(62, 62, 62)\",\n        height: window.innerHeight,\n        overflow: \"hidden\",\n      }}\n    >\n      {/* <ReactFlow elements={elements} nodeTypes={nodeTypes} /> */}\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          background: \"rgb(62, 62, 62)\",\n          flex: \"1 1 auto\",\n        }}\n      >\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            flex: \"1 60 auto\",\n            margin: \"10px\",\n            padding: \"10px\",\n            background: \"rgb(30 30 30)\",\n            borderRadius: \"3px\",\n          }}\n        >\n          <button\n            style={{\n              padding: \"10px\",\n              backgroundColor: \"#099\",\n              border: \"none\",\n              borderRadius: \"3px\",\n            }}\n            onClick={() => {\n              compute();\n            }}\n          >\n            Play\n          </button>\n          <div\n            style={{ display: \"flex\", flexDirection: \"row\", marginTop: \"10px\" }}\n          >\n            <button\n              style={{\n                padding: \"10px\",\n                backgroundColor: \"#099\",\n                border: \"none\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => loadPreset(tuto1)}\n            >\n              Tutorial 1\n            </button>\n            <button\n              style={{\n                marginLeft: \"5px\",\n                padding: \"10px\",\n                backgroundColor: \"#099\",\n                border: \"none\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => loadPreset(tuto2)}\n            >\n              Tutorial 2\n            </button>\n            <button\n              style={{\n                marginLeft: \"5px\",\n                padding: \"10px\",\n                backgroundColor: \"#099\",\n                border: \"none\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => loadPreset(tuto3)}\n            >\n              Tutorial 3\n            </button>\n            <button\n              style={{\n                marginLeft: \"5px\",\n                padding: \"10px\",\n                backgroundColor: \"#099\",\n                border: \"none\",\n                borderRadius: \"3px\",\n              }}\n              onClick={() => loadPreset(tuto4)}\n            >\n              Tutorial 4\n            </button>\n          </div>\n          <div style={{ fontSize: \"0.8em\", marginTop: \"10px\", color: \"white\" }}>\n            <div> Write your sound function on the right !</div>\n            <div>\n              The samples you return will be played on your speaker, and the\n              graphs your return plotted.\n            </div>\n            <div>\n              Sliders are auto-generated by comments starting with //use.\n            </div>\n          </div>\n\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"row\",\n              flex: \"1 1 auto\",\n              marginTop: \"20px\",\n              flexWrap: \"wrap\",\n            }}\n          >\n            {params.map((p) => (\n              <div\n                style={{\n                  display: \"flex\",\n                  flexDirection: \"row\",\n                }}\n              >\n                <RSlider\n                  name={p.name}\n                  min={p.min}\n                  max={p.max}\n                  step={p.step}\n                  value={p.value}\n                  unit={p.unit}\n                  onChange={(v) =>\n                    setSetting((old) => {\n                      let arr = old.params.slice();\n                      let elem = arr.find((e) => e.name === p.name);\n                      if (elem) elem.value = v;\n                      return { ...old, params: arr };\n                    })\n                  }\n                ></RSlider>\n              </div>\n            ))}\n          </div>\n\n          <div style={{ flex: \"5 1 auto\" }}></div>\n        </div>\n        <div\n          style={{\n            flex: \"1 1 auto\",\n            margin: \"10px\",\n            padding: \"0px\",\n            background: \"rgb(30 30 30)\",\n            minWidth: \"877px\",\n            borderRadius: \"3px\",\n            overflow: \"hidden\",\n          }}\n        >\n          <Editor\n            height=\"60vh\"\n            defaultLanguage=\"javascript\"\n            defaultValue={code}\n            value={code}\n            onChange={(v, e) => setCode(v)}\n            theme=\"vs-dark\"\n            options={{\n              fontSize: \"12\",\n            }}\n          />\n        </div>\n      </div>\n\n      <div\n        style={{\n          padding: \"10px\",\n          flex: \"1 1 auto\",\n          borderRadius: \"3px\",\n          overflow: \"hidden\",\n        }}\n      >\n        <canvas\n          ref={canvasRef}\n          width={window.innerWidth - 20 + \"\"}\n          height=\"300\"\n          style={{ width: window.innerWidth - 20 + \"px\", minHeight: \"50px\" }}\n        ></canvas>\n      </div>\n    </div>\n  );\n}\n","import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport React from \"react\";\n\nfunction polarToCartesian(centerX, centerY, radius, angle) {\n  return {\n    x: centerX + radius * Math.cos(angle),\n    y: centerY + radius * Math.sin(angle),\n  };\n}\n\nfunction describeArc(x, y, radius, startAngle, endAngle) {\n  var start = polarToCartesian(x, y, radius, endAngle);\n  var end = polarToCartesian(x, y, radius, startAngle);\n\n  var largeArcFlag = endAngle - startAngle <= Math.PI ? \"0\" : \"1\";\n\n  var d = [\n    \"M\",\n    start.x,\n    start.y,\n    \"A\",\n    radius,\n    radius,\n    0,\n    largeArcFlag,\n    0,\n    end.x,\n    end.y,\n  ].join(\" \");\n\n  return d;\n}\n\nconst WIDTH = 120;\nconst WIDTH_HALF = WIDTH / 2.0;\n\nfunction SvgComponent({ angle }) {\n  let state = useMemo(() => {\n    let a2 = angle + Math.PI / 2.0;\n    let arcpaths = [describeArc(90, 90, 70, Math.PI / 2.0, a2)];\n    if (a2 >= Math.PI * 2.5) {\n      arcpaths = [\n        describeArc(90, 90, 70, Math.PI / 2.0, Math.PI * 1.99 + Math.PI / 2.0),\n        describeArc(90, 90, 70, Math.PI / 2.0, a2 % (Math.PI * 2)),\n      ];\n    }\n\n    let cx = 90 + 70 * Math.cos(a2);\n    let cy = 90 + 70 * Math.sin(a2);\n\n    return {\n      arcpaths,\n      cx,\n      cy,\n    };\n  }, [angle]);\n\n  return (\n    <svg\n      width={WIDTH}\n      height={WIDTH}\n      viewBox=\"0 0 180 180\"\n      style={{\n        padding: 5,\n        boxSizing: \"border-box\",\n      }}\n    >\n      <circle\n        r={70}\n        cx={90}\n        cy={90}\n        strokeWidth={5}\n        stroke=\"#333\"\n        fill=\"none\"\n      />\n\n      {state.arcpaths.map((d, index) => (\n        <path\n          d={d}\n          strokeLinecap=\"round\"\n          strokeWidth={20}\n          stroke={index === 0 ? \"rgb(96, 197, 177)\" : \"#000000\"}\n          fill=\"none\"\n        />\n      ))}\n\n      <circle r={20} cx={state.cx} cy={state.cy} fill=\"#fff\" cursor=\"pointer\" />\n    </svg>\n  );\n}\n\nfunction format(step, value) {\n  if (Math.round(step) !== step) {\n    return Math.round(value * (1.0 / step)) / (1.0 / step) + \"\";\n  } else {\n    return Math.round(value) + \"\";\n  }\n}\n\nexport default function RSlider({\n  min,\n  max,\n  step,\n  value,\n  onChange,\n  maxTurn,\n  name,\n  unit,\n}) {\n  let angle = useMemo(() => (Math.PI * 2 * (value - min)) / (max - min));\n\n  let ref = useRef();\n\n  let mousemove = useCallback(\n    (event) => {\n      const rectSize = ref.current.getBoundingClientRect();\n      const width = rectSize.width;\n      let center = width / 2;\n      let relativeX = event.clientX - rectSize.left;\n      let relativeY = event.clientY - rectSize.top;\n      let angleBetweenTwoVectors = Math.atan2(\n        relativeY - center,\n        relativeX - center\n      );\n\n      angleBetweenTwoVectors =\n        (angleBetweenTwoVectors + Math.PI * 2 - Math.PI / 2) % (Math.PI * 2);\n      angleBetweenTwoVectors /= Math.PI * 2;\n\n      if (!isNaN(angleBetweenTwoVectors)) {\n        let newValue = min + (max - min) * angleBetweenTwoVectors;\n        newValue = Math.max(\n          min,\n          Math.min(max, Math.round(newValue / step) * step)\n        );\n        onChange(newValue);\n      }\n    },\n    [onChange, min, max, step]\n  );\n\n  let [clicked, setClicked] = useState(false);\n\n  useEffect(() => {\n    window.addEventListener(\"mouseup\", () => setClicked(false));\n  }, []);\n\n  useEffect(() => {\n    if (clicked) {\n      window.addEventListener(\"mousemove\", mousemove);\n      return () => window.removeEventListener(\"mousemove\", mousemove);\n    }\n  }, [clicked, mousemove]);\n\n  return (\n    <div>\n      <div\n        ref={ref}\n        style={{\n          width: WIDTH + \"px\",\n          height: WIDTH + \"px\",\n          position: \"relative\",\n        }}\n        onMouseDown={(e) => {\n          setClicked(true);\n          mousemove(e);\n        }}\n      >\n        <SvgComponent angle={angle}></SvgComponent>\n        <div\n          style={{\n            position: \"absolute\",\n            top: \"50%\",\n            left: \"50%\",\n            transform: \"translate(-50%,-50%)\",\n          }}\n        >\n          <div style={{ fontSize: \"0.7em\", fontWeight: \"bold\", color: \"grey\" }}>\n            {name}\n          </div>\n          <div style={{ color: \"rgb(100, 153, 211)\" }}>\n            {format(step, value) + \" \" + unit}\n          </div>\n        </div>\n      </div>\n\n      {/* <input\n        type=\"range\"\n        min={min + \"\"}\n        max={max + \"\"}\n        step={step + \"\"}\n        value={value + \"\"}\n        // onChange={(e) => onChange(e.target.value)}\n      ></input> */}\n    </div>\n  );\n}\n","var wrap = require('comlink').wrap,Worker = require(\"!worker-loader?{}!/home/ctrl/prog/natify/node_modules/comlink-loader/dist/comlink-worker-loader.js!/home/ctrl/prog/natify/node_modules/react-scripts/node_modules/babel-loader/lib/index.js??ref--5-oneOf-2!/home/ctrl/prog/natify/src/frag/Compute.js\"),inst;module.exports = function f() {if (this instanceof f) return wrap(Worker());return inst || (inst = wrap(Worker()));};","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"5edb37be28ce44b6b21d.worker.js\");\n};","export default __webpack_public_path__ + \"static/media/logo.6ce24c58.svg\";","import logo from \"./logo.svg\";\nimport \"./App.css\";\nimport EditorFrag from \"./frag/Editor\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <EditorFrag></EditorFrag>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}